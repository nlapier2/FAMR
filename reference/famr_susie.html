<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Factor-Augmented Mendelian Randomization with SuSiE (FAMR-Susie) — famr_susie • FAMR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Factor-Augmented Mendelian Randomization with SuSiE (FAMR-Susie) — famr_susie"><meta name="description" content='This is the main user-facing function that runs all parts of the
FAMR-Susie method, described in the manuscript
"Factor-based methods for robust high-dimensional Mendelian randomization".
FAMR-Susie is intended for use in "high-dimensional" MR, where there are
many genetically-correlated exposures, and simultaneously learns which of
these exposures have a causal effect on the "outcome" trait.
FAMR-Susie uses factor analysis to infer and correct for unobserved
confounders, and uses sparse polygenic modeling and Bayesian regression to
alleviate other challenges such as other violations of MR assumptions and
sparsity. For more details on the method, please see the manuscript.'><meta property="og:description" content='This is the main user-facing function that runs all parts of the
FAMR-Susie method, described in the manuscript
"Factor-based methods for robust high-dimensional Mendelian randomization".
FAMR-Susie is intended for use in "high-dimensional" MR, where there are
many genetically-correlated exposures, and simultaneously learns which of
these exposures have a causal effect on the "outcome" trait.
FAMR-Susie uses factor analysis to infer and correct for unobserved
confounders, and uses sparse polygenic modeling and Bayesian regression to
alleviate other challenges such as other violations of MR assumptions and
sparsity. For more details on the method, please see the manuscript.'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">FAMR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.10</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Factor-Augmented Mendelian Randomization with SuSiE (FAMR-Susie)</h1>

      <div class="d-none name"><code>famr_susie.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This is the main user-facing function that runs all parts of the
FAMR-Susie method, described in the manuscript
"Factor-based methods for robust high-dimensional Mendelian randomization".
FAMR-Susie is intended for use in "high-dimensional" MR, where there are
many genetically-correlated exposures, and simultaneously learns which of
these exposures have a causal effect on the "outcome" trait.
FAMR-Susie uses factor analysis to infer and correct for unobserved
confounders, and uses sparse polygenic modeling and Bayesian regression to
alleviate other challenges such as other violations of MR assumptions and
sparsity. For more details on the method, please see the manuscript.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">famr_susie</span><span class="op">(</span></span>
<span>  <span class="va">in_dir</span>,</span>
<span>  <span class="va">ld_dir</span>,</span>
<span>  y_gwas_file <span class="op">=</span> <span class="st">"NONE"</span>,</span>
<span>  fa_method <span class="op">=</span> <span class="st">"gfa"</span>,</span>
<span>  num_samples <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  n_iter <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  susieL <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  prune_thresh <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  fa_prune_thresh <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  final_prune_thresh <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  annihilate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  idcol <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  betacol <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  secol <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  header <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-in-dir">in_dir<a class="anchor" aria-label="anchor" href="#arg-in-dir"></a></dt>
<dd><p>A directory with input rds files containing summary statistics
for the exposures, with one file per locus. Each file should be a list object
with three matrices with SNPs as rows and exposure traits as columns. These
are "betas" (effect size estimates of SNPs on exposures), "stderrs"
(standard errors of the betas), and "Z" (the z-scores, i.e. betas/stderrs).
Optionally can also include corresponding vectors betas_y, stderrs_y, and
zscores_y for the outcome trait ("y"); alternatively, those can be read in
separately via the read_y_gwas function (see below).
Finally, it has a vector 'pos' with the SNP names.
See gather_sumstats for more information.</p></dd>


<dt id="arg-ld-dir">ld_dir<a class="anchor" aria-label="anchor" href="#arg-ld-dir"></a></dt>
<dd><p>A directory with input rds files containing LD matrices
corresponding to the SNPs in the summary statistics files, with one file
per locus. These should simply be numerical nSNP-by-nSNP matrices.</p></dd>


<dt id="arg-y-gwas-file">y_gwas_file<a class="anchor" aria-label="anchor" href="#arg-y-gwas-file"></a></dt>
<dd><p>An optional file path to the file with the outcome
summary statistics. Can either be a TSV file with columns for the SNP name,
effect size estimates, and standard errors (see idcol, betacol, secol),
or a VCF file in the MRC IEU GWAS format, described here:
https://github.com/MRCIEU/gwas-vcf-specification
See also read_vcf in utils.R.</p></dd>


<dt id="arg-fa-method">fa_method<a class="anchor" aria-label="anchor" href="#arg-fa-method"></a></dt>
<dd><p>The factor analysis (FA) method to be used. This defaults to
'gfa' and generally should not be changed, as FAMR-Susie currently only
recognizes 'gfa'. If the user wishes to modify the code to allow different FA
methods, they can specify those different methods here. Currently, if the
user puts in something other than 'gfa', no factors are inferred.
This can potentially be useful if the user wants to assess FAMR-Susie both
with and without factors.</p></dd>


<dt id="arg-num-samples">num_samples<a class="anchor" aria-label="anchor" href="#arg-num-samples"></a></dt>
<dd><p>The number of samples that were used to generate the
exposure summary statistics. If this varies between the exposures, it can be
something like the average – it does not have to be exact.</p></dd>


<dt id="arg-n-iter">n_iter<a class="anchor" aria-label="anchor" href="#arg-n-iter"></a></dt>
<dd><p>The number of Expectation Maximization iterations to fit the
cTWAS-style algorithm to learn prior effect probabilities for SNPs and
exposures/factors. Default: 30.</p></dd>


<dt id="arg-susiel">susieL<a class="anchor" aria-label="anchor" href="#arg-susiel"></a></dt>
<dd><p>The maximum number of effects (credible sets) allowed in the
susie_rss runs. Default: 30.</p></dd>


<dt id="arg-prune-thresh">prune_thresh<a class="anchor" aria-label="anchor" href="#arg-prune-thresh"></a></dt>
<dd><p>The absolute value correlation threshold used in the LD
clumping step performed by FAMR-Susie before any further analysis. This is
done to improve computational speed and stabilize results. We generally
recommend a value between 0.3 and 0.9; the default is 0.5.</p></dd>


<dt id="arg-fa-prune-thresh">fa_prune_thresh<a class="anchor" aria-label="anchor" href="#arg-fa-prune-thresh"></a></dt>
<dd><p>A stricter clumping threshold to generate a set of
SNPs for input to factor analysis with GFA. Default: 0.1. It is not generally
recommended to change this value much.</p></dd>


<dt id="arg-final-prune-thresh">final_prune_thresh<a class="anchor" aria-label="anchor" href="#arg-final-prune-thresh"></a></dt>
<dd><p>A stricted clumping threshold to generate a set of
SNPs to model in the cTWAS-style framework / susie_rss runs. By default it is
0.1, the same as fa_prune_thresh.</p></dd>


<dt id="arg-annihilate">annihilate<a class="anchor" aria-label="anchor" href="#arg-annihilate"></a></dt>
<dd><p>Boolean; whether to regress factor summary statistics out
of exposure and outcome summary statistics after the FA stage and before
polygenic modeling and Bayesian regression. Setting this to TRUE will likely
yield a conservative result. Default: FALSE.</p></dd>


<dt id="arg-idcol">idcol<a class="anchor" aria-label="anchor" href="#arg-idcol"></a></dt>
<dd><p>Column of y_gwas_file with the SNP IDs (names). Default is 1,
i.e. the first column. Not used if a VCF is provided.</p></dd>


<dt id="arg-betacol">betacol<a class="anchor" aria-label="anchor" href="#arg-betacol"></a></dt>
<dd><p>Column of y_gwas_file with the SNP effect sizes (betas).
Default is 2, i.e. the second column. Not used if a VCF is provided.</p></dd>


<dt id="arg-secol">secol<a class="anchor" aria-label="anchor" href="#arg-secol"></a></dt>
<dd><p>Column of y_gwas_file with the SNP effect standard errors.
Default is 3, i.e. the third column. Not used if a VCF is provided.</p></dd>


<dt id="arg-header">header<a class="anchor" aria-label="anchor" href="#arg-header"></a></dt>
<dd><p>Boolean indicating whether the y_gwas_file has a header line,
e.g. with column names. Default=TRUE. Not used if a VCF is provided.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with some or all of the following elements:</p>
<dl><dt>pips</dt>
<dd><p>A list of the learned PIPs for each exposure, factor, and SNP.</p></dd>


<dt>zscores</dt>
<dd><p>A list of the marginal association z-scores learned for each
exposure, factor, and SNP with the outcome.</p></dd>


<dt>R</dt>
<dd><p>A matrix of the estimated correlations between each pair of
variables (exposures, factors, and SNPs).</p></dd>


<dt>susieres</dt>
<dd><p>The full susie_rss results object. See the susieR
documentation for more details.</p></dd>


<dt>priors</dt>
<dd><p>A list containing the learned prior effect probabilities and
prior effect variances learned for each class of variables (i.e. SNPs and
exposures/factors).</p></dd>


<dt>posterior_mean</dt>
<dd><p>A list containing the posterior means learned for
each variable by susie_rss.</p></dd>


<dt>posterior_var</dt>
<dd><p>A list containing the posterior variances learned for
each variable by susie_rss.</p></dd>


<dt>factor_corrs</dt>
<dd><p>A matrix of correlations between the learned factor
summary statistics and those of the exposures. Deprecated in favor of the
R matrix.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The famr_susie method expects summary statistics and
linkage disequilibrium (LD) matrices as input. The user is expected to have
split their data into independent loci before running famr_susie.
Thus famr_susie expects a directory (in_dir) of summary statistics and
another (ld_dir) for LD matrices, with one file each per locus.
The data for the outcome phenotype may be included in the summary statistics
files or supplied separately via the y_gwas_file argument.
For the formats of these files, see the documentation for gather_sumstats
and read_y_gwas, respectively.
The remaining arguments are explained below.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nathan LaPierre.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

