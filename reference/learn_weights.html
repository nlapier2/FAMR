<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Learn weights of SNP effects on exposures and factors — learn_weights • FAMR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Learn weights of SNP effects on exposures and factors — learn_weights"><meta name="description" content='Learns the "weights" (joint effect sizes) of SNPs on each exposure and
factor, using Susie-RSS. Uses the lambda parameters learned by learn_lambda
for regularization. Adjusts other Susie parameters adaptively according to
lambda, i.e. the "L" (number of effects) parameter and clumping threshold.'><meta property="og:description" content='Learns the "weights" (joint effect sizes) of SNPs on each exposure and
factor, using Susie-RSS. Uses the lambda parameters learned by learn_lambda
for regularization. Adjusts other Susie parameters adaptively according to
lambda, i.e. the "L" (number of effects) parameter and clumping threshold.'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">FAMR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.14</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Getting_Started.html">Getting Started</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nlapier2/FAMR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Learn weights of SNP effects on exposures and factors</h1>
      <small class="dont-index">Source: <a href="https://github.com/nlapier2/FAMR/blob/main/R/famr.R" class="external-link"><code>R/famr.R</code></a></small>
      <div class="d-none name"><code>learn_weights.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Learns the "weights" (joint effect sizes) of SNPs on each exposure and
factor, using Susie-RSS. Uses the lambda parameters learned by learn_lambda
for regularization. Adjusts other Susie parameters adaptively according to
lambda, i.e. the "L" (number of effects) parameter and clumping threshold.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">learn_weights</span><span class="op">(</span></span>
<span>  <span class="va">sumstats</span>,</span>
<span>  <span class="va">ld</span>,</span>
<span>  <span class="va">lambda</span>,</span>
<span>  nome <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  N <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  L <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  prune_min <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  prune_max <span class="op">=</span> <span class="fl">0.5</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-sumstats">sumstats<a class="anchor" aria-label="anchor" href="#arg-sumstats"></a></dt>
<dd><p>A list object, usually read by gather_sumstats. The list has
three matrices with SNPs as rows and exposure traits as columns. These
are "betas" (effect size estimates of SNPs on exposures), "stderrs"
(standard errors of the betas), and "Z" (the z-scores, i.e. betas/stderrs).
See gather_sumstats for more details.</p></dd>


<dt id="arg-ld">ld<a class="anchor" aria-label="anchor" href="#arg-ld"></a></dt>
<dd><p>numeric LD matrix corresponding to the SNPs in sumstats</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>numeric vector of lambda parameters, one per trait, learned by
learne_lambda.</p></dd>


<dt id="arg-nome">nome<a class="anchor" aria-label="anchor" href="#arg-nome"></a></dt>
<dd><p>DEPRECATED. used only for internal testing. in this case,
it automatically returns the "betas" as the weights, as it assumes a no
measurement error (nome) model.</p></dd>


<dt id="arg-n">N<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>number of samples used to generate the exposure data, passed as an
argument to susie-rss.</p></dd>


<dt id="arg-l">L<a class="anchor" aria-label="anchor" href="#arg-l"></a></dt>
<dd><p>maximum number of effects (per-trait) susie-rss can model</p></dd>


<dt id="arg-prune-min">prune_min<a class="anchor" aria-label="anchor" href="#arg-prune-min"></a></dt>
<dd><p>this sets the minimum LD clumping threshold allowed to be
applied for any trait, after adjusting for the lambda parameter.</p></dd>


<dt id="arg-prune-max">prune_max<a class="anchor" aria-label="anchor" href="#arg-prune-max"></a></dt>
<dd><p>this sets the maximum LD clumping threshold allowed to be
applied for any trait, after adjusting for the lambda parameter.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a numeric matrix of weights learned for each SNP on each exposure
and factor, with one row per SNP and one column per exposure and factor.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nathan LaPierre, Matthew Stephens, Xin He.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

