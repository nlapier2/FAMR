<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generate factors for FAMR-Susie — generate_factors • FAMR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate factors for FAMR-Susie — generate_factors"><meta name="description" content="Generate factors given the summary statistics read in by gather_sumstats.
Since the factors are usually learned with a more strictly LD-clumped set
of summary statistics, this function also imputes the SNP-factor effect size
estimates for the rest of the SNPs."><meta property="og:description" content="Generate factors given the summary statistics read in by gather_sumstats.
Since the factors are usually learned with a more strictly LD-clumped set
of summary statistics, this function also imputes the SNP-factor effect size
estimates for the rest of the SNPs."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">FAMR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Generate factors for FAMR-Susie</h1>

      <div class="d-none name"><code>generate_factors.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Generate factors given the summary statistics read in by gather_sumstats.
Since the factors are usually learned with a more strictly LD-clumped set
of summary statistics, this function also imputes the SNP-factor effect size
estimates for the rest of the SNPs.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">generate_factors</span><span class="op">(</span></span>
<span>  <span class="va">fa_method</span>,</span>
<span>  <span class="va">sumstats</span>,</span>
<span>  N <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  given_factors <span class="op">=</span> <span class="st">"NONE"</span>,</span>
<span>  full_ss <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-fa-method">fa_method<a class="anchor" aria-label="anchor" href="#arg-fa-method"></a></dt>
<dd><p>A string providing the factor analysis method to use.
Currently this only recognizes 'gfa', but this could be extended to recognize
other options in the future. If anything other than 'gfa' is passed in, the
method assumes no factors should be generated.</p></dd>


<dt id="arg-sumstats">sumstats<a class="anchor" aria-label="anchor" href="#arg-sumstats"></a></dt>
<dd><p>Input summary statistics to use for factor analysis, usually
from gather_sumstats. A list object with the following elements:</p>
<dl><dt>betas</dt>
<dd><p>A matrix of estimated effect sizes of SNPs on exposures, with
rows corresponding to SNPs and columns corresponding to exposures.</p></dd>


<dt>stderrs</dt>
<dd><p>A matrix of standard errors for the betas.</p></dd>


<dt>Z</dt>
<dd><p>A matrix of z-scores for the exposures, equal to betas divided by
stderrs.</p></dd>


<dt>pos</dt>
<dd><p>A vector of SNP names.</p></dd>


</dl></dd>


<dt id="arg-n">N<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Sample size of the studies used to generate GWAS summary statistics.</p></dd>


<dt id="arg-given-factors">given_factors<a class="anchor" aria-label="anchor" href="#arg-given-factors"></a></dt>
<dd><p>DEPRECATED. A file path to factor summary statistics
that have been pre-generated by the user. Used for internal testing purposes.</p></dd>


<dt id="arg-full-ss">full_ss<a class="anchor" aria-label="anchor" href="#arg-full-ss"></a></dt>
<dd><p>Similar to sumstats, but contains the full set of SNPs to be
used in further analysis, i.e. if prune_thresh is greater than
fa_prune_thresh in gather_sumstats.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list object containing inferred summary statistics for factors,
with the following elements:</p>
<dl><dt>betas</dt>
<dd><p>A matrix of estimated effect sizes of SNPs on exposures, with
rows corresponding to SNPs and columns corresponding to exposures.</p></dd>


<dt>stderrs</dt>
<dd><p>A matrix of standard errors for the betas.</p></dd>


<dt>Z</dt>
<dd><p>A matrix of z-scores for the exposures, equal to betas divided by
stderrs.</p></dd>


<dt>pos</dt>
<dd><p>A vector of SNP names.</p></dd>


<dt>n_factors</dt>
<dd><p>Number of inferred factors.</p></dd>


</dl></div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nathan LaPierre.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

