<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Precompute values for Z-scores and R for this locus — precompute_zxy • FAMR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Precompute values for Z-scores and R for this locus — precompute_zxy"><meta name="description" content='FAMR-Susie builds a Z-score for each exposure and factor with the outcome, as
well as a matrix of their correlations with one another (R). In general,
these would be constructed using all SNPs across the genome with an effect on
any exposure or factor. However, that can yield a very large R matrix.
Instead, we can "precompute" some values needed to compute Z and R separately
for each independent locus, which is what this method does, and then build
Z and R later using the precomputed values from each locus.'><meta property="og:description" content='FAMR-Susie builds a Z-score for each exposure and factor with the outcome, as
well as a matrix of their correlations with one another (R). In general,
these would be constructed using all SNPs across the genome with an effect on
any exposure or factor. However, that can yield a very large R matrix.
Instead, we can "precompute" some values needed to compute Z and R separately
for each independent locus, which is what this method does, and then build
Z and R later using the precomputed values from each locus.'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">FAMR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Precompute values for Z-scores and R for this locus</h1>

      <div class="d-none name"><code>precompute_zxy.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>FAMR-Susie builds a Z-score for each exposure and factor with the outcome, as
well as a matrix of their correlations with one another (R). In general,
these would be constructed using all SNPs across the genome with an effect on
any exposure or factor. However, that can yield a very large R matrix.
Instead, we can "precompute" some values needed to compute Z and R separately
for each independent locus, which is what this method does, and then build
Z and R later using the precomputed values from each locus.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">precompute_zxy</span><span class="op">(</span><span class="va">weights</span>, <span class="va">z_gy</span>, <span class="va">ld</span>, orig_z_gy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>, n_factors <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>a numeric matrix of "weights" of each SNP on each exposure and
factor in this locus, usually learned by learn_weights, with one row per SNP
and one column per exposure/factor.</p></dd>


<dt id="arg-z-gy">z_gy<a class="anchor" aria-label="anchor" href="#arg-z-gy"></a></dt>
<dd><p>a vector of SNP Z-scores on the outcome trait</p></dd>


<dt id="arg-ld">ld<a class="anchor" aria-label="anchor" href="#arg-ld"></a></dt>
<dd><p>the LD matrix corresponding to the SNPs in weights</p></dd>


<dt id="arg-orig-z-gy">orig_z_gy<a class="anchor" aria-label="anchor" href="#arg-orig-z-gy"></a></dt>
<dd><p>SNP z-scores on the outcome trait prior to annihilation, if
applicable. see annihilate_factors.</p></dd>


<dt id="arg-n-factors">n_factors<a class="anchor" aria-label="anchor" href="#arg-n-factors"></a></dt>
<dd><p>number of inferred factors</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a list with three values, "numerator", "wRw", and "Rgx". numerator
is the numerator of the z-score for this locus. wRw is a normalizing matrix
of associations between traits, used for computing both Z and R. "Rgx" is
a matrix of SNP-trait correlations, with one row per SNP and one column per
exposure/factor.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nathan LaPierre.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

