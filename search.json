[{"path":"http://www.nathanrlapierre.com/FAMR/articles/Getting_Started.html","id":"downloading-sample-data-understanding-input-format","dir":"Articles","previous_headings":"","what":"Downloading sample data, understanding input format","title":"Getting Started","text":"start, let’s download sample data: Now go ahead examine directory structure. ’ll notice two sub-directories, one summary statistics files one linkage disequilibrium (LD) matrices. Let’s take look summary statistics files: shows format summary statistics input file. simulated dataset, 100 loci, 100 SNPs , 30 exposures. 100 summary statistics files. following fields: * betas: (num_snp, num_exposure) numeric matrix marginal summary statistics effect sizes (e.g. GWAS) SNP locus exposure. * stderrs: corresponding standard errors betas * Z: corresponding Z-scores, .e. betas / stderrs * pos: names SNPs fields required, file additional fields. betas_y, stderrs_y, zscores_y vectors summary statistics outcome trait (y) SNP. can included summary statistics files, shown , can also specified separate file; see y_gwas_file argument famr_susie function documentation famr.R. also locus_idx specifies locus SNPs come . normally stored internally needed input. Please note also names exposures included column names Z matrix, software pulls exposure names . simulated data, exposures named. Similarly, can look LD matrices: just numeric (num_snp, num_snp) matrices giving LD pair SNPs. ’s file input format. FAMR easiest use directory summary statistics files separate directory LD files, one per locus, alphabetically order. Let’s now see run FAMR.","code":"wget https://zenodo.org/records/15191402/files/sample_data_famr.zip?download=1 unzip sample_data_famr.zip\\?download\\=1 rm sample_data_famr.zip\\?download\\=1 # str(readRDS('sample_data_famr/summary_statistics/job_0_res__sumstats_locus_1.rds'))  # Should look like this: # List of 8 #  $ betas    : num [1:100, 1:30] -0.00114 -0.01379 -0.01378 -0.0132 -0.00901 ... #  $ stderrs  : num [1:100, 1:30] 0.0141 0.0141 0.0141 0.0141 0.0141 ... #  $ Z        : num [1:100, 1:30] -0.0808 -0.9753 -0.9742 -0.9333 -0.6368 ... #  $ zscores_y: num [1:100] 1.11 0.351 0.347 -0.807 0.462 ... #  $ betas_y  : num [1:100] 0.01569 0.00496 0.00491 -0.01142 0.00653 ... #  $ stderrs_y: num [1:100] 0.0141 0.0141 0.0141 0.0141 0.0141 ... #  $ pos      : chr [1:100] \"rs4303582\" \"rs77266488\" \"rs4583279\" \"rs201264110\" ... #  $ locus_idx: int [1:100] 1 1 1 1 1 1 1 1 1 1 ... # str(readRDS('sample_data_famr/ld_matrices/job_0_res__ld_locus_1.rds'))   # num [1:100, 1:100] 1 -0.0684 -0.0684 -0.1645 0.2496 ...  # - attr(*, \"dimnames\")=List of 2  #  ..$ : chr [1:100] \"rs4303582\" \"rs77266488\" \"rs4583279\" \"rs201264110\" ...  #  ..$ : chr [1:100] \"rs4303582\" \"rs77266488\" \"rs4583279\" \"rs201264110\" ..."},{"path":"http://www.nathanrlapierre.com/FAMR/articles/Getting_Started.html","id":"running-the-package-examining-the-results","dir":"Articles","previous_headings":"","what":"Running the package, examining the results","title":"Getting Started","text":"Now let’s load FAMR package run sample data. Please note code may take couple minutes run. code assumes current working directory one ’ve downloaded sample data . ’ll running main user-facing function, famr_susie. Optionally, loading FAMR package, can try running ?famr_susie see description function available options. make results easier read, let’s name exposures. Normally won’t exposure names stored column names Z matrix summary statistics files. simulated exposures don’t names, ’ll add readability. Now let’s examine results. main thing want look “posterior inclusion probabilities” (PIPs) variables, indicate probability exposures factors causal. can also look marginal z-scores variables outcome. simulation, exposures 1-4 true causal effect outcome, exposures 5-30 false positives. well! got three four true exposures, false positives (assuming PIP threshold 0.9). Exposure 1 weakest causal effect simulation, ’s surprising didn’t capture one. Notice method infers two factors also assigns high PIPs. simulation, three true factors, true causal effect outcome. well . z-score data mostly ’d expect – traits high PIPs tend also high z-scores. However, ’s interesting nuggets. example, exposure 8 fairly strong z-score -4.04, stronger inferred factor1, z-score 3.9. Yet exposure 8 low PIP (desired). factors significantly correlated outcome, often interesting see exposures highly correlated . can reveal information biology factor captures. ’s real biology simulation, ’ll see, can also reveal interesting things see results. can look “R” matrix results object, captures correlations traits inferred FAMR: ’re examining correlation exposure 8 traits. Factors listed exposures, factor 2 32nd trait (appearing 30 exposures). see exposure 8 strong negative correlation (r=-0.78) factor 2. Since factor 2 strongly positively associated outcome (Z=5.5), can explain negative association exposure 8 (Z=-4.0) due negative correlation factor 2. Thus, reasonable FAMR conclude exposure 8 truly causal. note however real data often substantially complicated always straightforward.","code":"# library(FAMR)  # res = famr_susie('sample_data_famr/summary_statistics/', #                  'sample_data_famr/ld_matrices/') # n_factor = length(res$pips$exposures) - 30 # names(res$pips$exposures) = c(paste0('expo', 1:30), paste0('factor', 1:n_factor)) # names(res$zscores$exposures) = names(res$pips$exposures) # res$pips$exposures # Should look like: #      expo1      expo2      expo3      expo4      expo5      expo6      expo7  # 0.02168038 0.99999993 1.00000000 1.00000000 0.03006273 0.02086431 0.06564261  #      expo8      expo9     expo10     expo11     expo12     expo13     expo14  # 0.01245198 0.01370268 0.14287961 0.02131342 0.01176360 0.04154705 0.04598993  #     expo15     expo16     expo17     expo18     expo19     expo20     expo21  # 0.02630846 0.03138122 0.01241316 0.05116290 0.01697360 0.01172528 0.01712106  #     expo22     expo23     expo24     expo25     expo26     expo27     expo28  # 0.01412207 0.08089835 0.01236670 0.01174409 0.01187538 0.11216748 0.01420045  #     expo29     expo30    factor1    factor2  # 0.01952278 0.01228583 0.99999989 1.00000000    # res$zscores$exposures # Should look like: #          [,1]     [,2]    [,3]     [,4]     [,5]     [,6]     [,7]      [,8] # [1,] 1.195137 7.718487 9.03478 11.53807 0.341561 1.408553 1.385941 -4.041805 #           [,9]      [,10]    [,11]     [,12]    [,13]    [,14]    [,15] # [1,] 0.1843671 -0.8247518 1.246944 -3.631046 4.314023 -2.30429 4.793901 #         [,16]      [,17]     [,18]    [,19]     [,20]    [,21]     [,22] # [1,] -1.63629 0.08748619 0.8926834 -3.18582 0.1878442 0.421557 0.7395468 #          [,23]     [,24]     [,25]      [,26]    [,27]     [,28]       [,29] # [1,] -1.751231 -1.756996 -1.940141 -0.8266286 3.974921 0.9517898 0.007001429 #           [,30]    [,31]    [,32] # [1,] -0.8680636 3.866268 5.542907 # attr(,\"names\") #  [1] \"expo1\"   \"expo2\"   \"expo3\"   \"expo4\"   \"expo5\"   \"expo6\"   \"expo7\"   #  [8] \"expo8\"   \"expo9\"   \"expo10\"  \"expo11\"  \"expo12\"  \"expo13\"  \"expo14\"  # [15] \"expo15\"  \"expo16\"  \"expo17\"  \"expo18\"  \"expo19\"  \"expo20\"  \"expo21\"  # [22] \"expo22\"  \"expo23\"  \"expo24\"  \"expo25\"  \"expo26\"  \"expo27\"  \"expo28\"  # [29] \"expo29\"  \"expo30\"  \"factor1\" \"factor2\" # library(Matrix)  # R is a sparse Matrix object  # res$R[8,1:32] # Should look like: #  [1]  1.184749e-09 -2.785313e-02  3.160052e-03  1.701398e-02  1.019044e-02 #  [6] -1.286696e-02 -1.257566e-02  1.000000e+00 -5.366847e-02 -1.561301e-02 # [11] -4.302502e-02  1.342948e-02 -2.742825e-01 -9.099744e-04 -3.544528e-02 # [16]  2.026822e-01  8.945676e-02  1.107069e-01 -1.144439e-02 -3.069334e-02 # [21] -1.768171e-01 -5.851117e-02 -6.325104e-02 -1.649924e-02  1.483735e-01 # [26]  2.498381e-03  2.920885e-02 -1.332901e-02 -4.281362e-02  9.737442e-02 # [31]  6.100231e-03 -7.833054e-01"},{"path":"http://www.nathanrlapierre.com/FAMR/articles/Getting_Started.html","id":"some-other-useful-outputs","dir":"Articles","previous_headings":"","what":"Some other useful outputs","title":"Getting Started","text":"FAMR results object several useful components. : susieres stores full SuSiE results object. SuSiE-RSS FAMR uses regression step. Particularly useful look susieres$sets$cs$, shows “credible sets” inferred SuSiE. One traits credible set inferred causal effect, SuSiE unsure among variables credible set causal. See SuSiE documentation details. example, credible sets multiple traits. priors contains priors inferred CTWAS-style framework FAMR. priors$pi prior probabilities traits class (exposures SNPs ) causal, priors$sigma2 gives prior variance class. pips$factors PIPs factors fitted separate regression, factors predictor variables (exposures SNPs). FAMR places heavy prior factors full regression, sometimes separate regression provides useful (yet rough) sensitivity analysis factors.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Nathan LaPierre. Author, maintainer. Matthew Stephens. Author. Xin . Author.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"LaPierre N, Stephens M, X (2025). FAMR: Factor-Augmented Mendelian Randomization SuSiE (FAMR-Susie). R package version 0.0.14, https://github.com/nlapier2/FAMR/, https://www.nathanrlapierre.com/FAMR.","code":"@Manual{,   title = {FAMR: Factor-Augmented Mendelian Randomization with SuSiE (FAMR-Susie)},   author = {Nathan LaPierre and Matthew Stephens and Xin He},   year = {2025},   note = {R package version 0.0.14, https://github.com/nlapier2/FAMR/},   url = {https://www.nathanrlapierre.com/FAMR}, }"},{"path":"http://www.nathanrlapierre.com/FAMR/index.html","id":"factor-augmented-mendelian-randomization-with-susie-famr-susie","dir":"","previous_headings":"","what":"Factor-Augmented Mendelian Randomization with SuSiE (FAMR-Susie)","title":"Factor-Augmented Mendelian Randomization with SuSiE (FAMR-Susie)","text":"FAMR package implements FAMR-Susie method 1 described manuscript “Factor-based methods robust high-dimensional Mendelian randomization” 2. FAMR-Susie intended use “high-dimensional” MR, many genetically-correlated exposures, simultaneously learns exposures causal effect “outcome” trait. example, one application simultaneously infer many metabolites measured biobank dataset causal effect heart disease. FAMR-Susie uses factor analysis infer correct unobserved confounders, builds sparse polygenic models exposures inferred factors, uses sparse Bayesian regression infer exposures factors causal. input GWAS summary statistics exposures outcome trait interest, primary output posterior inclusion probabilities (PIPs) exposures inferred factors, indicating estimated probability traits causal effect outcome. recommend interested users read manuscript 3 details method. Additionally, sparse polygenic modeling Bayesian regression stages based around modified versions cTWAS susieR packages, users may find helpful look context. Please see installation instructions link simple vignette. recommend running vignette get feel using package input output format.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Factor-Augmented Mendelian Randomization with SuSiE (FAMR-Susie)","text":"simplest way install package open R shell run can run load package.","code":"library(devtools) devtools::install_github('nlapier2/FAMR') library(FAMR)"},{"path":"http://www.nathanrlapierre.com/FAMR/index.html","id":"quick-start","dir":"","previous_headings":"","what":"Quick Start","title":"Factor-Augmented Mendelian Randomization with SuSiE (FAMR-Susie)","text":"recommend following vignette quick introduction package input output formats: Getting Started","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Factor-Augmented Mendelian Randomization with SuSiE (FAMR-Susie)","text":"use package, please cite manuscript: (FORTHCOMING)","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/annihilate_factors.html","id":null,"dir":"Reference","previous_headings":"","what":"Regress factors out of exposures and outcome — annihilate_factors","title":"Regress factors out of exposures and outcome — annihilate_factors","text":"optional method regresses factor summary statistics exposure outcome summary statistics factor analysis stage polygenic modeling Bayesian regression. likely yield conservative result. default, famr_susie run . See gather_sumstats details.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/annihilate_factors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Regress factors out of exposures and outcome — annihilate_factors","text":"","code":"annihilate_factors(sumstats, factor_ss)"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/annihilate_factors.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Regress factors out of exposures and outcome — annihilate_factors","text":"sumstats list object, usually read gather_sumstats. list three matrices SNPs rows exposure traits columns. \"betas\" (effect size estimates SNPs exposures), \"stderrs\" (standard errors betas), \"Z\" (z-scores, .e. betas/stderrs). also three corresponding vectors betas_y, stderrs_y, zscores_y outcome trait (\"y\"). also vector 'pos' SNP names. factor_ss Like sumstats, list object betas, stderrs, Z matrices, except factors instead exposures. Usually generated generate_factors. must also integer n_factors giving number factors. must set SNPs sumstats.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/annihilate_factors.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Regress factors out of exposures and outcome — annihilate_factors","text":"modified version sumstats object. summary statistics exposures outcome factors projected (regressed) . adds fields orig_betas_y orig_zscores_y, values fields annihilation, annih_y, portion outcome projected . Thus, orig_betas_y = betas_y + annih_y returned object.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/coef.susie.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract regression coefficients from susie fit — coef.susie","title":"Extract regression coefficients from susie fit — coef.susie","text":"Extract regression coefficients susie fit","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/coef.susie.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract regression coefficients from susie fit — coef.susie","text":"","code":"# S3 method for class 'susie' coef(object, ...)"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/coef.susie.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract regression coefficients from susie fit — coef.susie","text":"object susie fit. ... Additional arguments passed generic coef method.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/coef.susie.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract regression coefficients from susie fit — coef.susie","text":"p+1 vector, first element intercept, remaining p elements estimated regression coefficients.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/compute_ss.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute sufficient statistics for susie. — compute_ss","title":"Compute sufficient statistics for susie. — compute_ss","text":"Compute sufficient statistics susie.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/compute_ss.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute sufficient statistics for susie. — compute_ss","text":"","code":"compute_ss(X, y, standardize = TRUE)"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/compute_ss.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute sufficient statistics for susie. — compute_ss","text":"X n p matrix covariates. y n vector. standardize Logical flag indicating whether standardize columns X unit variance prior fitting.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/compute_ss.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute sufficient statistics for susie. — compute_ss","text":"list sufficient statistics.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/estimate_priors_EM.html","id":null,"dir":"Reference","previous_headings":"","what":"cTWAS EM algorithm to optimize priors — estimate_priors_EM","title":"cTWAS EM algorithm to optimize priors — estimate_priors_EM","text":"Implements cTWAS Expectation-Maximization (EM) algorithm fitting prior probabilities variances variables \"class\" (SNPs exposures/factors). iteration runs Susie-RSS current priors, updates priors given Susie-RSS results.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/estimate_priors_EM.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"cTWAS EM algorithm to optimize priors — estimate_priors_EM","text":"","code":"estimate_priors_EM(zscores, R, L = 1, n_iter = 30)"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/estimate_priors_EM.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"cTWAS EM algorithm to optimize priors — estimate_priors_EM","text":"zscores numeric vector z-score association statistics variables trait interest. R numeric matrix sparse Matrix object correlations variables L maximum number effects (credible sets) Susie-RSS allowed fit. n_iter Number EM iterations run.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/estimate_priors_EM.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"cTWAS EM algorithm to optimize priors — estimate_priors_EM","text":"list object following elements: pi list containing updated cTWAS prior inclusion probability (prior probability effect trait) class variables sigma2 list containing updated cTWAS prior effect variances, conditioned variable effect, class variables n_vars list object giving number variables class, e.g. ('SNPs' = 10000, 'exposures' = 30)","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/famr_susie.html","id":null,"dir":"Reference","previous_headings":"","what":"Factor-Augmented Mendelian Randomization with SuSiE (FAMR-Susie) — famr_susie","title":"Factor-Augmented Mendelian Randomization with SuSiE (FAMR-Susie) — famr_susie","text":"main user-facing function runs parts FAMR-Susie method, described manuscript \"Factor-based methods robust high-dimensional Mendelian randomization\". FAMR-Susie intended use \"high-dimensional\" MR, many genetically-correlated exposures, simultaneously learns exposures causal effect \"outcome\" trait. FAMR-Susie uses factor analysis infer correct unobserved confounders, uses sparse polygenic modeling Bayesian regression alleviate challenges violations MR assumptions sparsity. details method, please see manuscript.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/famr_susie.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Factor-Augmented Mendelian Randomization with SuSiE (FAMR-Susie) — famr_susie","text":"","code":"famr_susie(   in_dir,   ld_dir,   y_gwas_file = \"NONE\",   fa_method = \"gfa\",   num_samples = 10000,   n_iter = 30,   susieL = 30,   prune_thresh = 0.5,   fa_prune_thresh = 0.1,   final_prune_thresh = 0.1,   annihilate = FALSE,   idcol = 1,   betacol = 2,   secol = 3,   header = TRUE )"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/famr_susie.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Factor-Augmented Mendelian Randomization with SuSiE (FAMR-Susie) — famr_susie","text":"in_dir directory input rds files containing summary statistics exposures, one file per locus. file list object three matrices SNPs rows exposure traits columns. \"betas\" (effect size estimates SNPs exposures), \"stderrs\" (standard errors betas), \"Z\" (z-scores, .e. betas/stderrs). Optionally can also include corresponding vectors betas_y, stderrs_y, zscores_y outcome trait (\"y\"); alternatively, can read separately via read_y_gwas function (see ). Finally, vector 'pos' SNP names. See gather_sumstats information. ld_dir directory input rds files containing LD matrices corresponding SNPs summary statistics files, one file per locus. simply numerical nSNP--nSNP matrices. y_gwas_file optional file path file outcome summary statistics. Can either TSV file columns SNP name, effect size estimates, standard errors (see idcol, betacol, secol), VCF file MRC IEU GWAS format, described : https://github.com/MRCIEU/gwas-vcf-specification See also read_vcf utils.R. fa_method factor analysis (FA) method used. defaults 'gfa' generally changed, FAMR-Susie currently recognizes 'gfa'. user wishes modify code allow different FA methods, can specify different methods . Currently, user puts something 'gfa', factors inferred. can potentially useful user wants assess FAMR-Susie without factors. num_samples number samples used generate exposure summary statistics. varies exposures, can something like average – exact. n_iter number Expectation Maximization iterations fit cTWAS-style algorithm learn prior effect probabilities SNPs exposures/factors. Default: 30. susieL maximum number effects (credible sets) allowed susie_rss runs. Default: 30. prune_thresh absolute value correlation threshold used LD clumping step performed FAMR-Susie analysis. done improve computational speed stabilize results. generally recommend value 0.3 0.9; default 0.5. fa_prune_thresh stricter clumping threshold generate set SNPs input factor analysis GFA. Default: 0.1. generally recommended change value much. final_prune_thresh stricted clumping threshold generate set SNPs model cTWAS-style framework / susie_rss runs. default 0.1, fa_prune_thresh. annihilate Boolean; whether regress factor summary statistics exposure outcome summary statistics FA stage polygenic modeling Bayesian regression. Setting TRUE likely yield conservative result. Default: FALSE. idcol Column y_gwas_file SNP IDs (names). Default 1, .e. first column. used VCF provided. betacol Column y_gwas_file SNP effect sizes (betas). Default 2, .e. second column. used VCF provided. secol Column y_gwas_file SNP effect standard errors. Default 3, .e. third column. used VCF provided. header Boolean indicating whether y_gwas_file header line, e.g. column names. Default=TRUE. used VCF provided.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/famr_susie.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Factor-Augmented Mendelian Randomization with SuSiE (FAMR-Susie) — famr_susie","text":"list following elements: pips list learned PIPs exposure, factor, SNP. zscores list marginal association z-scores learned exposure, factor, SNP outcome. R matrix estimated correlations pair variables (exposures, factors, SNPs). susieres full susie_rss results object. See susieR documentation details. priors list containing learned prior effect probabilities prior effect variances learned class variables (.e. SNPs exposures/factors). posterior_mean list containing posterior means learned variable susie_rss. posterior_var list containing posterior variances learned variable susie_rss. factor_corrs matrix correlations learned factor summary statistics exposures. Deprecated favor R matrix.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/famr_susie.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Factor-Augmented Mendelian Randomization with SuSiE (FAMR-Susie) — famr_susie","text":"famr_susie method expects summary statistics linkage disequilibrium (LD) matrices input. user expected split data independent loci running famr_susie. Thus famr_susie expects directory (in_dir) summary statistics another (ld_dir) LD matrices, one file per locus. data outcome phenotype may included summary statistics files supplied separately via y_gwas_file argument. formats files, see documentation gather_sumstats read_y_gwas, respectively. remaining arguments explained .","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/gather_sumstats.html","id":null,"dir":"Reference","previous_headings":"","what":"Gather summary statistics for exposures — gather_sumstats","title":"Gather summary statistics for exposures — gather_sumstats","text":"Given directories containing summary statistics LD matrices one independent loci, reads data merges data outcome trait, applicable. Also performs LD clumping reduce computational cost.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/gather_sumstats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gather summary statistics for exposures — gather_sumstats","text":"","code":"gather_sumstats(   in_dir,   ld_dir,   y_gwas = c(),   oracle_mode = F,   prune_thresh = 1,   fa_prune_thresh = 1 )"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/gather_sumstats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gather summary statistics for exposures — gather_sumstats","text":"in_dir directory input rds files containing summary statistics exposures, one file per locus. file list object three matrices SNPs rows exposure traits columns. \"betas\" (effect size estimates SNPs exposures), \"stderrs\" (standard errors betas), \"Z\" (z-scores, .e. betas/stderrs). Optionally can also include corresponding vectors betas_y, stderrs_y, zscores_y outcome trait (\"y\"); alternatively, can read separately via read_y_gwas function. Finally, vector 'pos' SNP names. ld_dir directory input rds files containing LD matrices corresponding SNPs summary statistics files, one file per locus. simply numerical nSNP--nSNP matrices. y_gwas list four items: names_y, betas_y, stderrs_y, zscores_y, giving IDs, estimated effect sizes, standard errors, z-scores SNPs outcome trait, respectively. Usually produced read_y_gwas function. data outcome included files in_dir, leave blank (default). oracle_mode DEPRECATED. Used internal testing purposes. prune_thresh LD clumping threshold; numeric value 0 1. Default 0.5. fa_prune_thresh Stricter LD clumping threshold used generate set SNPs input factor analysis. Default: 0.1.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/gather_sumstats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gather summary statistics for exposures — gather_sumstats","text":"list object following elements: betas matrix estimated effect sizes SNPs exposures, rows corresponding SNPs columns corresponding exposures. weights Currently betas; later used store learned weights SNPs exposures factors. stderrs matrix standard errors betas. Z matrix z-scores exposures, equal betas divided stderrs. betas_y vector estimated effect sizes SNPs outcome. stderrs_y vector standard errors betas_y. zscores_y vector z-scores SNPs outcome, equal betas_y divided stderrs_y. pos vector SNP names. locus_idx vector matching SNPs locus come , indexed order loci read in_dir. lambda matrix lambda values learned learn_lambda exposure locus, row matrix corresponds locus columns exposures. ss_for_fa list object \"betas\", \"stderrs\", \"Z\", \"weights\", \"pos\" fields, SNPs input factor analysis.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/gather_sumstats_from_dat.html","id":null,"dir":"Reference","previous_headings":"","what":"Gather summary statistics for exposures from R objects — gather_sumstats_from_dat","title":"Gather summary statistics for exposures from R objects — gather_sumstats_from_dat","text":"Similar gather_sumstats, takes R objects input instead directories containing files. words, assumes data already read , just need merge outcome data, perform LD clumping, learn lambda regularization parameters.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/gather_sumstats_from_dat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gather summary statistics for exposures from R objects — gather_sumstats_from_dat","text":"","code":"gather_sumstats_from_dat(   all_ss,   all_ld,   y_gwas = c(),   oracle_mode = F,   prune_thresh = 1,   fa_prune_thresh = 1 )"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/gather_sumstats_from_dat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gather summary statistics for exposures from R objects — gather_sumstats_from_dat","text":"all_ss list object following elements: betas matrix estimated effect sizes SNPs exposures, rows corresponding SNPs columns corresponding exposures. weights Currently betas; later used store learned weights SNPs exposures factors. stderrs matrix standard errors betas. Z matrix z-scores exposures, equal betas divided stderrs. pos vector SNP names. locus_idx vector matching SNPs locus come , indexed order loci read in_dir. all_ld list mapping locus indices (see ) corresponding LD matrices locus. numerical nSNP--nSNP matrices. y_gwas list four items: names_y, betas_y, stderrs_y, zscores_y, giving IDs, estimated effect sizes, standard errors, z-scores SNPs outcome trait, respectively. Usually produced read_y_gwas function. data outcome included files in_dir, leave blank (default). oracle_mode DEPRECATED. Used internal testing purposes. prune_thresh LD clumping threshold; numeric value 0 1. Default 0.5. fa_prune_thresh Stricter LD clumping threshold used generate set SNPs input factor analysis. Default: 0.1.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/gather_sumstats_from_dat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gather summary statistics for exposures from R objects — gather_sumstats_from_dat","text":"list object following elements: betas matrix estimated effect sizes SNPs exposures, rows corresponding SNPs columns corresponding exposures. weights Currently betas; later used store learned weights SNPs exposures factors. stderrs matrix standard errors betas. Z matrix z-scores exposures, equal betas divided stderrs. betas_y vector estimated effect sizes SNPs outcome. stderrs_y vector standard errors betas_y. zscores_y vector z-scores SNPs outcome, equal betas_y divided stderrs_y. pos vector SNP names. locus_idx vector matching SNPs locus come , indexed order loci read in_dir. lambda matrix lambda values learned learn_lambda exposure locus, row matrix corresponds locus columns exposures. ss_for_fa list object \"betas\", \"stderrs\", \"Z\", \"weights\", \"pos\" fields, SNPs input factor analysis.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/generate_factors.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate factors for FAMR-Susie — generate_factors","title":"Generate factors for FAMR-Susie — generate_factors","text":"Generate factors given summary statistics read gather_sumstats. Since factors usually learned strictly LD-clumped set summary statistics, function also imputes SNP-factor effect size estimates rest SNPs.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/generate_factors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate factors for FAMR-Susie — generate_factors","text":"","code":"generate_factors(   fa_method,   sumstats,   N = 10000,   given_factors = \"NONE\",   full_ss = c() )"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/generate_factors.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate factors for FAMR-Susie — generate_factors","text":"fa_method string providing factor analysis method use. Currently recognizes 'gfa', extended recognize options future. anything 'gfa' passed , method assumes factors generated. sumstats Input summary statistics use factor analysis, usually gather_sumstats. list object following elements: betas matrix estimated effect sizes SNPs exposures, rows corresponding SNPs columns corresponding exposures. stderrs matrix standard errors betas. Z matrix z-scores exposures, equal betas divided stderrs. pos vector SNP names. N Sample size studies used generate GWAS summary statistics. given_factors DEPRECATED. file path factor summary statistics pre-generated user. Used internal testing purposes. full_ss Similar sumstats, contains full set SNPs used analysis, .e. prune_thresh greater fa_prune_thresh gather_sumstats.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/generate_factors.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate factors for FAMR-Susie — generate_factors","text":"list object containing inferred summary statistics factors, following elements: betas matrix estimated effect sizes SNPs exposures, rows corresponding SNPs columns corresponding exposures. weights Currently betas; later used store learned weights SNPs factors. stderrs matrix standard errors betas. Z matrix z-scores exposures, equal betas divided stderrs. pos vector SNP names. n_factors Number inferred factors.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/get_cs_correlation.html","id":null,"dir":"Reference","previous_headings":"","what":"Get correlations between CS, using variable with maximum PIP from each CS — get_cs_correlation","title":"Get correlations between CS, using variable with maximum PIP from each CS — get_cs_correlation","text":"Get correlations CS, using variable maximum PIP CS","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/get_cs_correlation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get correlations between CS, using variable with maximum PIP from each CS — get_cs_correlation","text":"","code":"get_cs_correlation(res, X = NULL, Xcorr = NULL, max = FALSE)"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/get_cs_correlation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get correlations between CS, using variable with maximum PIP from each CS — get_cs_correlation","text":"X n p matrix values p variables (covariates) n samples. provided, correlation variables computed used remove CSs whose minimum correlation among variables smaller min_abs_corr. Xcorr p p matrix correlations variables (covariates). provided, used remove CSs whose minimum correlation among variables smaller min_abs_corr.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/get_results.html","id":null,"dir":"Reference","previous_headings":"","what":"Run final Susie-RSS regression and return results — get_results","title":"Run final Susie-RSS regression and return results — get_results","text":"Runs Susie-RSS given prior inclusion probabilities prior variances class variables, returns comprehensive results object. Intended used cTWAS prior-fitting EM algorithm run.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/get_results.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run final Susie-RSS regression and return results — get_results","text":"","code":"get_results(zscores, R, priors = c(), L = 10)"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/get_results.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run final Susie-RSS regression and return results — get_results","text":"zscores numeric vector z-score association statistics variables trait interest. R numeric matrix sparse Matrix object correlations variables priors list object following elements: pi list containing updated cTWAS prior inclusion probability (prior probability effect trait) class variables sigma2 list containing updated cTWAS prior effect variances, conditioned variable effect, class variables n_vars list object giving number variables class, e.g. ('SNPs' = 10000, 'exposures' = 30) L maximum number effects (credible sets) Susie-RSS allowed fit.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/get_results.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run final Susie-RSS regression and return results — get_results","text":"list object following elements: pips list object elements class variables, containing numeric vector PIPs variables class posterior_var list object elements class variables, containing numeric vector posterior second moments (conditioned variable effect) variables class posterior_mean list object elements class variables, containing numeric vector posterior mean effect size estimates variables class susieres Susie-RSS results object returned run_susie_with_priors; see susieR documentation details. zscores Equal zscores parameter given input. R Equal R parameter given input. L Equal L parameter given input. sorted_pips DEPRECATED. unlisted (vector-format) pips sorted decreasing order.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/gfa_factor_prune_full.html","id":null,"dir":"Reference","previous_headings":"","what":"Prune GFA factors associated with only one exposure — gfa_factor_prune_full","title":"Prune GFA factors associated with only one exposure — gfa_factor_prune_full","text":"GFA occasionally infers factors strongly associated one exposure others, essentially proxy exposure. helper function removes factors heuristically, removing factors R^2 value (\"thresh\") least \"min_count\" exposures.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/gfa_factor_prune_full.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prune GFA factors associated with only one exposure — gfa_factor_prune_full","text":"","code":"gfa_factor_prune_full(x_betas, gfares, thresh = 0.1, min_count = 2)"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/gfa_factor_prune_full.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prune GFA factors associated with only one exposure — gfa_factor_prune_full","text":"x_betas Numeric matrix marginal effect size estimates (\"betas\") SNPs exposure, rows corresponding SNPs columns corresponding exposures. gfares GFA results object, usually generated run_gfa_full. thresh R^2 threshold exposures factors gfares must meet avoid removed. Default: 0.1. min_count number exposures factor must sufficiently correlated avoid removed. Default: 2.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/gfa_factor_prune_full.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prune GFA factors associated with only one exposure — gfa_factor_prune_full","text":"GFA object (see GFA details); modified version gfares contains factors passed filter.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/impute_exposure_corrs.html","id":null,"dir":"Reference","previous_headings":"","what":"Form correlation matrix of all variables — impute_exposure_corrs","title":"Form correlation matrix of all variables — impute_exposure_corrs","text":"Generates correlation matrix pairs variables, including SNPs, exposures, factors, given weights learned learn_weights f amr.R LD SNPs. Can optionally take wRw Rgx (see ) already computed.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/impute_exposure_corrs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Form correlation matrix of all variables — impute_exposure_corrs","text":"","code":"impute_exposure_corrs(ld, weights, wRw = c(), Rgx = c())"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/impute_exposure_corrs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Form correlation matrix of all variables — impute_exposure_corrs","text":"ld numeric matrix sparse Matrix object linkage disequilibrium (LD) values pair SNPs, SNPs weights parameter/ weights numeric matrix SNP weights exposures factors, rows corresponding SNPs columns expsosures factors. wRw numeric matrix associations traits (exposures factors), used computing Z R. See precompute_zxy famr.R details. Rgx numeric matrix inferred correlations SNPs traits (exposures outcomes), one row per SNP one column per exposure/factor.See precompute_zxy famr.R details.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/impute_exposure_corrs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Form correlation matrix of all variables — impute_exposure_corrs","text":"numeric matrix sparse Matrix object containing inferred correlations SNPs, exposures, factors.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/ld_prune_famr.html","id":null,"dir":"Reference","previous_headings":"","what":"LD clump SNPs in a locus — ld_prune_famr","title":"LD clump SNPs in a locus — ld_prune_famr","text":"simple helper function LD clump SNPs locus. Given clumping threshold summary statistics object LD matrix, returns list SNP indices keep clumping. SNPs sorted descending order highest Z-score exposure, SNPs marked removal high enough LD SNP stronger peak Z-score. kept indices usually passed subset_sumstats actually remove SNPs.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/ld_prune_famr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"LD clump SNPs in a locus — ld_prune_famr","text":"","code":"ld_prune_famr(sumstats, ld, prune_thresh)"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/ld_prune_famr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"LD clump SNPs in a locus — ld_prune_famr","text":"sumstats summary statistics list object, containing following fields (possibly others): betas matrix estimated effect sizes SNPs exposures, rows corresponding SNPs columns corresponding exposures. stderrs matrix standard errors betas. Z matrix z-scores exposures, equal betas divided stderrs. ld numeric matrix LD values SNPs sumstats prune_thresh numeric value 0 1 indicating LD clumping threshold.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/ld_prune_famr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"LD clump SNPs in a locus — ld_prune_famr","text":"vector SNP indices marked retained LD clumping.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/learn_lambda.html","id":null,"dir":"Reference","previous_headings":"","what":"Learn regularization parameters for Susie-RSS weight learning — learn_lambda","title":"Learn regularization parameters for Susie-RSS weight learning — learn_lambda","text":"function learns \"lambda\" parameter regularize LD matrix SNPs case mismatch populations LD reference panel population summary statistics gathered . improves stability weights learned Susie-RSS learn_weights. lambdas 0 1 one learned trait independent locus. lambda=0 regularization, lambda=1 sets R identity matrix.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/learn_lambda.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Learn regularization parameters for Susie-RSS weight learning — learn_lambda","text":"","code":"learn_lambda(sumstats, ld, oracle_mode = F)"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/learn_lambda.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Learn regularization parameters for Susie-RSS weight learning — learn_lambda","text":"sumstats list object, usually read gather_sumstats. list three matrices SNPs rows exposure traits columns. \"betas\" (effect size estimates SNPs exposures), \"stderrs\" (standard errors betas), \"Z\" (z-scores, .e. betas/stderrs). See gather_sumstats details. ld numeric LD matrix corresponding SNPs sumstats oracle_mode DEPRECATED. used internal testing. case, automatically returns 0 lambda parameters, .e. regularization.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/learn_lambda.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Learn regularization parameters for Susie-RSS weight learning — learn_lambda","text":"numerical vector learned lambda parameters trait locus. 0 1.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/learn_weights.html","id":null,"dir":"Reference","previous_headings":"","what":"Learn weights of SNP effects on exposures and factors — learn_weights","title":"Learn weights of SNP effects on exposures and factors — learn_weights","text":"Learns \"weights\" (joint effect sizes) SNPs exposure factor, using Susie-RSS. Uses lambda parameters learned learn_lambda regularization. Adjusts Susie parameters adaptively according lambda, .e. \"L\" (number effects) parameter clumping threshold.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/learn_weights.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Learn weights of SNP effects on exposures and factors — learn_weights","text":"","code":"learn_weights(   sumstats,   ld,   lambda,   nome = F,   N = 10000,   L = 10,   prune_min = 0.1,   prune_max = 0.5 )"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/learn_weights.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Learn weights of SNP effects on exposures and factors — learn_weights","text":"sumstats list object, usually read gather_sumstats. list three matrices SNPs rows exposure traits columns. \"betas\" (effect size estimates SNPs exposures), \"stderrs\" (standard errors betas), \"Z\" (z-scores, .e. betas/stderrs). See gather_sumstats details. ld numeric LD matrix corresponding SNPs sumstats lambda numeric vector lambda parameters, one per trait, learned learne_lambda. nome DEPRECATED. used internal testing. case, automatically returns \"betas\" weights, assumes measurement error (nome) model. N number samples used generate exposure data, passed argument susie-rss. L maximum number effects (per-trait) susie-rss can model prune_min sets minimum LD clumping threshold allowed applied trait, adjusting lambda parameter. prune_max sets maximum LD clumping threshold allowed applied trait, adjusting lambda parameter.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/learn_weights.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Learn weights of SNP effects on exposures and factors — learn_weights","text":"numeric matrix weights learned SNP exposure factor, one row per SNP one column per exposure factor.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/learn_wts_precomp_merge.html","id":null,"dir":"Reference","previous_headings":"","what":"Learn weights for SNPs, compute values for Z and R, merge data across loci — learn_wts_precomp_merge","title":"Learn weights for SNPs, compute values for Z and R, merge data across loci — learn_wts_precomp_merge","text":"Essentially large wrapper function takes summary statistics exposures factors prepares data necessary impute Z-scores R matrix used cTWAS/Susie regression step. Merges sumstats exposures factors, learns weights exposures factors, precomputes values needed impute entries Z-scores vector R matrix corresponding exposures factors, LD clumps merges data single sumstats object LD object.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/learn_wts_precomp_merge.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Learn weights for SNPs, compute values for Z and R, merge data across loci — learn_wts_precomp_merge","text":"","code":"learn_wts_precomp_merge(   all_sumstats,   factor_ss,   N = 10000,   nome = F,   prune_thresh = 1 )"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/learn_wts_precomp_merge.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Learn weights for SNPs, compute values for Z and R, merge data across loci — learn_wts_precomp_merge","text":"all_sumstats list object, usually generated gather_sumstats, following elements: betas matrix estimated effect sizes SNPs exposures, rows corresponding SNPs columns corresponding exposures. weights Currently betas; later used store learned weights SNPs exposures factors. stderrs matrix standard errors betas. Z matrix z-scores exposures, equal betas divided stderrs. betas_y vector estimated effect sizes SNPs outcome. stderrs_y vector standard errors betas_y. zscores_y vector z-scores SNPs outcome, equal betas_y divided stderrs_y. pos vector SNP names. locus_idx vector matching SNPs locus come , indexed order loci read in_dir. lambda matrix lambda values learned learn_lambda exposure locus, row matrix corresponds locus columns exposures. factor_ss list object containing inferred summary statistics factors, usually generate_factors, following elements: betas matrix estimated effect sizes SNPs factors, rows corresponding SNPs columns corresponding factors. weights Currently betas; later used store learned weights SNPs exposures factors. stderrs matrix standard errors betas. Z matrix z-scores exposures, equal betas divided stderrs. pos vector SNP names. n_factors Number inferred factors. N Number samples summary statistics generated using. nome DEPRECATED. Boolean value indicating whether assume \"measurement error\" model. Default: FALSE. Used internal testing purposes. prune_thresh Numeric value 0 1 indicating final LD clumping threshold applied data merging loci. SNPs removed step still used learn weights compute Z R, included final cTWAS/Susie regression.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/learn_wts_precomp_merge.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Learn weights for SNPs, compute values for Z and R, merge data across loci — learn_wts_precomp_merge","text":"list object following elements: sumstats list object containing summary statistics exposures factors; see all_sumstats parameter format. \"weights\" element now contains weights learned Susie-RSS. ld sparse Matrix object LD SNPs sumstats object. numerator numeric vector representing numerator Z-scores exposure factor. wRw numeric matrix associations traits (exposures factors), used computing Z R Rgx numeric matrix inferred correlations SNPs traits (exposures outcomes), one row per SNP one column per exposure/factor.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/merge_ld.html","id":null,"dir":"Reference","previous_headings":"","what":"Merge LD for a locus into overall LD matrix — merge_ld","title":"Merge LD for a locus into overall LD matrix — merge_ld","text":"function meant called several functions famr.R loop loci. Given LD matrix (all_ld) representing merged loci far LD matrix current locus, merges two together new LD matrix returns . LD different loci assumed zero.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/merge_ld.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Merge LD for a locus into overall LD matrix — merge_ld","text":"","code":"merge_ld(all_ld, locus_ld)"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/merge_ld.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Merge LD for a locus into overall LD matrix — merge_ld","text":"all_ld numeric matrix sparse Matrix object containing linkage disequilibrium (LD) values pair SNPs previous loci. locus_ld numeric matrix sparse Matrix object containing LD values pair SNPs current locus.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/merge_ld.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Merge LD for a locus into overall LD matrix — merge_ld","text":"numeric matrix sparse Matrix object containing SNPs all_ld locus_ld.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/merge_outcome.html","id":null,"dir":"Reference","previous_headings":"","what":"Merge outcome and exposure summary statistics — merge_outcome","title":"Merge outcome and exposure summary statistics — merge_outcome","text":"Given exposure summary statistics outcome summary statistics, intersects SNPs, merges single object. Used read_y_gwas run, .e. outcome summary statistics already included exposure summary statistics files.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/merge_outcome.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Merge outcome and exposure summary statistics — merge_outcome","text":"","code":"merge_outcome(sumstats, y_gwas, ld = c())"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/merge_outcome.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Merge outcome and exposure summary statistics — merge_outcome","text":"sumstats list object following elements, .e. summary statistics exposures: betas matrix estimated effect sizes SNPs exposures, rows corresponding SNPs columns corresponding exposures. weights Currently betas; later used store learned weights SNPs exposures factors. stderrs matrix standard errors betas. Z matrix z-scores exposures, equal betas divided stderrs. pos vector SNP names. y_gwas list object following elements, .e. summary statistics outcome: names_y vector SNP IDs (names) betas_y vector estimated effect sizes SNPs outcome. stderrs_y vector standard errors betas_y. zscores_y vector z-scores SNPs outcome, equal betas_y divided stderrs_y. ld numeric LD matrix SNPs sumstats.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/merge_outcome.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Merge outcome and exposure summary statistics — merge_outcome","text":"list object following elements: sumstats list fields sumstats y_gwas (except names_y, merged pos), containing merged summary statistics ld numeric LD matrix SNPs new sumstats object; input LD matrix except without SNPs unmeasured y_gwas.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/merge_sumstats.html","id":null,"dir":"Reference","previous_headings":"","what":"Merge sumstats for a locus into overall sumstats — merge_sumstats","title":"Merge sumstats for a locus into overall sumstats — merge_sumstats","text":"function meant called several functions famr.R loop loci. Given object containing summary statistics merged loci far (all_sumstats) summary statistics new locus, merges two returns new summary statistics object. Also used merge exposure factor summary statistics.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/merge_sumstats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Merge sumstats for a locus into overall sumstats — merge_sumstats","text":"","code":"merge_sumstats(all_sumstats, locus_sumstats, by_row = T)"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/merge_sumstats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Merge sumstats for a locus into overall sumstats — merge_sumstats","text":"all_sumstats summary statistics list object, containing following fields (betas, stderrs, weights, Z required): betas matrix estimated effect sizes SNPs exposures, rows corresponding SNPs columns corresponding exposures. weights matrix weights learned SNP exposure, rows corresponding SNPs columns corresponding exposures. stderrs matrix standard errors betas. Z matrix z-scores exposures, equal betas divided stderrs. betas_y vector estimated effect sizes SNPs outcome. stderrs_y vector standard errors betas_y. zscores_y vector z-scores SNPs outcome, equal betas_y divided stderrs_y. pos vector SNP names. locus_idx vector matching SNPs locus come , indexed order loci read in_dir. lambda matrix lambda values learned learn_lambda famr.R exposure locus, row matrix corresponds locus columns exposures. locus_sumstats Like all_sumstats, current locus . by_row Boolean indicating whether sumstats merged row column. latter used merging exposure factor summary statistics rather merging different loci.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/merge_sumstats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Merge sumstats for a locus into overall sumstats — merge_sumstats","text":"list object format all_sumstats, merged summary statistics all_sumstats locus_sumstats.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/precompute_zxy.html","id":null,"dir":"Reference","previous_headings":"","what":"Precompute values for Z-scores and R for this locus — precompute_zxy","title":"Precompute values for Z-scores and R for this locus — precompute_zxy","text":"FAMR-Susie builds Z-score exposure factor outcome, well matrix correlations one another (R). general, constructed using SNPs across genome effect exposure factor. However, can yield large R matrix. Instead, can \"precompute\" values needed compute Z R separately independent locus, method , build Z R later using precomputed values locus.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/precompute_zxy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Precompute values for Z-scores and R for this locus — precompute_zxy","text":"","code":"precompute_zxy(weights, z_gy, ld, orig_z_gy = c(), n_factors = 0)"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/precompute_zxy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Precompute values for Z-scores and R for this locus — precompute_zxy","text":"weights numeric matrix \"weights\" SNP exposure factor locus, usually learned learn_weights, one row per SNP one column per exposure/factor. z_gy vector SNP Z-scores outcome trait ld LD matrix corresponding SNPs weights orig_z_gy SNP z-scores outcome trait prior annihilation, applicable. see annihilate_factors. n_factors number inferred factors","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/precompute_zxy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Precompute values for Z-scores and R for this locus — precompute_zxy","text":"list three values, \"numerator\", \"wRw\", \"Rgx\". numerator numerator z-score locus. wRw normalizing matrix associations traits, used computing Z R. \"Rgx\" matrix SNP-trait correlations, one row per SNP one column per exposure/factor.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/predict.susie.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict outcomes or extract coefficients from susie fit. — predict.susie","title":"Predict outcomes or extract coefficients from susie fit. — predict.susie","text":"Predict outcomes extract coefficients susie fit.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/predict.susie.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict outcomes or extract coefficients from susie fit. — predict.susie","text":"","code":"# S3 method for class 'susie' predict(object, newx = NULL, type = c(\"response\", \"coefficients\"), ...)"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/predict.susie.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict outcomes or extract coefficients from susie fit. — predict.susie","text":"object susie fit. newx new value X predictions. type type output. type = \"response\", predicted fitted outcomes returned; type =   \"coefficients\", estimated coefficients returned. ... arguments used generic predict function. extra arguments used .","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/predict.susie.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict outcomes or extract coefficients from susie fit. — predict.susie","text":"type = \"response\", predicted fitted outcomes returned; type = \"coefficients\", estimated coefficients returned.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/prune_and_merge.html","id":null,"dir":"Reference","previous_headings":"","what":"Wrapper function to clump and merge SNPs — prune_and_merge","title":"Wrapper function to clump and merge SNPs — prune_and_merge","text":"simple wrapper function performs LD clumping SNPs locus, subsets SNPs, merges SNPs locus object collecting summary statistics loci. Used gather_sumstats read individual locus files single object memory.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/prune_and_merge.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wrapper function to clump and merge SNPs — prune_and_merge","text":"","code":"prune_and_merge(   dat,   sumstats,   ld,   prune_thresh,   fa_prune_thresh,   f_idx,   oracle_mode = F )"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/prune_and_merge.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wrapper function to clump and merge SNPs — prune_and_merge","text":"dat list object formed merging previous loci, following elements: betas matrix estimated effect sizes SNPs exposures, rows corresponding SNPs columns corresponding exposures. stderrs matrix standard errors betas. weights Currently betas; later used store learned weights SNPs exposures factors. Z matrix z-scores exposures, equal betas divided stderrs. betas_y vector estimated effect sizes SNPs outcome. stderrs_y vector standard errors betas_y. zscores_y vector z-scores SNPs outcome, equal betas_y divided stderrs_y. pos vector SNP names. locus_idx vector matching SNPs locus come , indexed order loci read in_dir. lambda matrix lambda values learned learn_lambda exposure locus, row matrix corresponds locus columns exposures. ss_for_fa list object \"betas\", \"stderrs\", \"Z\", \"weights\", \"pos\" fields, SNPs input factor analysis. sumstats list object format dat, corresponding current locus ld numertic LD matrix SNPs sumstats (current locus) prune_thresh numeric value 0 1 indicating LD clumping threshold used ld_prune_famr fa_prune_thresh numeric value 0 1 indicating LD clumping threshold used generate set SNPs input factor analysis (FA) f_idx current file index, used indicate locus SNPs sumstats come oracle_mode DEPRECATED. Used internal testing .","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/prune_and_merge.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wrapper function to clump and merge SNPs — prune_and_merge","text":"list object format dat, containing SNPs dat sumstats removed LD clumping.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/read_vcf.html","id":null,"dir":"Reference","previous_headings":"","what":"Read summary statistics from a VCF file — read_vcf","title":"Read summary statistics from a VCF file — read_vcf","text":"Given VCF file containing summary statistics trait, read preprocess summary statistics, .e. performing NA, MAF, QC filtering . VCF file must MRC IEU GWAS format, described : https://github.com/MRCIEU/gwas-vcf-specification","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/read_vcf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read summary statistics from a VCF file — read_vcf","text":"","code":"read_vcf(fname)"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/read_vcf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read summary statistics from a VCF file — read_vcf","text":"fname VCF file name","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/read_vcf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read summary statistics from a VCF file — read_vcf","text":"data.frame object one row per SNP following column fields (omitting used methods): CHR Chromosome SNP . ID ID (name) SNP. BETA Estimated marginal effect size SNP trait. SE Standard errors BETAs. Z Z-scores SNPs trait. logp Log p-values association SNP trait.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/read_y_gwas.html","id":null,"dir":"Reference","previous_headings":"","what":"Read in outcome trait summary statistics — read_y_gwas","title":"Read in outcome trait summary statistics — read_y_gwas","text":"Optional helper function read summary statistics outcome trait, used already provided summary statistics files read in_dir (see famr_susie function documentation).","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/read_y_gwas.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read in outcome trait summary statistics — read_y_gwas","text":"","code":"read_y_gwas(y_gwas_file, idcol, betacol, secol, header = T)"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/read_y_gwas.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read in outcome trait summary statistics — read_y_gwas","text":"y_gwas_file File path file outcome summary statistics. Can either TSV file columns SNP name, effect size estimates, standard errors (see idcol, betacol, secol), VCF file MRC IEU GWAS format, described : https://github.com/MRCIEU/gwas-vcf-specification See also read_vcf utils.R. idcol Column y_gwas_file SNP IDs (names). used VCF provided. betacol Column y_gwas_file SNP effect sizes (betas). used VCF provided. secol Column y_gwas_file SNP effect standard errors. used VCF provided. header Boolean indicating whether y_gwas_file header line, e.g. column names. Default=TRUE. used VCF provided.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/read_y_gwas.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read in outcome trait summary statistics — read_y_gwas","text":"Returns list four items: names_y, betas_y, stderrs_y, zscores_y, giving IDs, estimated effect sizes, standard errors, z-scores SNPs outcome trait, respectively.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/run_gfa_full.html","id":null,"dir":"Reference","previous_headings":"","what":"Run GFA for factor analysis — run_gfa_full","title":"Run GFA for factor analysis — run_gfa_full","text":"Wrapper function run GFA infer factors FAMR, catching errors happen factors inferred removing factors strongly associated one factor.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/run_gfa_full.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run GFA for factor analysis — run_gfa_full","text":"","code":"run_gfa_full(x_betas, x_stderrs, N)"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/run_gfa_full.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run GFA for factor analysis — run_gfa_full","text":"x_betas Numeric matrix marginal effect size estimates (\"betas\") SNPs exposure, rows corresponding SNPs columns corresponding exposures. x_stderrs Numeric matrix standard errors x_betas. N DEPRECATED. Sample size used generate exposures.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/run_gfa_full.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run GFA for factor analysis — run_gfa_full","text":"GFA object; see GFA details. FAMR, relevant fields L_hat F_hat, contain loadings factors inferred GFA. L_hat dimension nSNPs--nFactors, t(F_hat) dimension nFactors--nExposures.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/run_modified_ctwas.html","id":null,"dir":"Reference","previous_headings":"","what":"Run cTWAS-style regression framework — run_modified_ctwas","title":"Run cTWAS-style regression framework — run_modified_ctwas","text":"Given output learn_wts_precomp_merge, computes final Z-score vector R matrix, uses cTWAS-style framework infer priors \"class\" variables (SNPs exposures/factors), generates final PIPs variable using Susie-RSS. Also runs separate factor-regression isolate factor effects exposure effects.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/run_modified_ctwas.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run cTWAS-style regression framework — run_modified_ctwas","text":"","code":"run_modified_ctwas(dat, L, n_iter, n_expo, n_samp, annih)"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/run_modified_ctwas.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run cTWAS-style regression framework — run_modified_ctwas","text":"dat list object, usually learn_wts_precomp_merge, following elements: sumstats list object containing summary statistics exposures factors; see all_sumstats parameter learn_wts_precomp_merge format. ld sparse Matrix object LD SNPs sumstats object. numerator numeric vector representing numerator Z-scores exposure factor. wRw numeric matrix associations traits (exposures factors), used computing Z R Rgx numeric matrix inferred correlations SNPs traits (exposures outcomes), one row per SNP one column per exposure/factor. L numeric value representing maximum number effects (precisely, credible sets) Susie-RSS can model outcome n_iter number cTWAS expectation-maximization (EM) iterations run fitting prior parameters; usually 10-30 good. n_expo number exposures analyzed n_samp number samples used generate exposure summary statistics annih boolean indicating whether annihilate flag used (whether factors regressed exposures outcome). See annihilate_factors details.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/run_modified_ctwas.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run cTWAS-style regression framework — run_modified_ctwas","text":"list following elements: pips list learned PIPs exposure, factor, SNP. zscores list marginal association z-scores learned exposure, factor, SNP outcome. R matrix estimated correlations pair variables (exposures, factors, SNPs). susieres full susie_rss results object. See susieR documentation details. priors list containing learned prior effect probabilities prior effect variances learned class variables (.e. SNPs exposures/factors). posterior_mean list containing posterior means learned variable susie_rss. posterior_var list containing posterior variances learned variable susie_rss. factor_corrs matrix correlations learned factor summary statistics exposures. Deprecated favor R matrix.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/run_susie_with_priors.html","id":null,"dir":"Reference","previous_headings":"","what":"Run Susie-RSS with cTWAS-inferred priors — run_susie_with_priors","title":"Run Susie-RSS with cTWAS-inferred priors — run_susie_with_priors","text":"wrapper function run Susie-RSS priors variable given cTWAS algorithm current EM iteration.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/run_susie_with_priors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run Susie-RSS with cTWAS-inferred priors — run_susie_with_priors","text":"","code":"run_susie_with_priors(zscores, R, prior_pi = c(), prior_sigma2 = c(), L = 10)"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/run_susie_with_priors.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run Susie-RSS with cTWAS-inferred priors — run_susie_with_priors","text":"zscores numeric vector z-score association statistics variables trait interest. R numeric matrix sparse Matrix object correlations variables prior_pi list containing updated cTWAS prior inclusion probability (prior probability effect trait) class variables (SNPs exposures/factors) prior_sigma2 list containing updated cTWAS prior effect variances, conditioned variable effect, class v ariables (SNPs exposures/factors) L maximum number effects (credible sets) Susie-RSS allowed fit.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/run_susie_with_priors.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run Susie-RSS with cTWAS-inferred priors — run_susie_with_priors","text":"Susie-RSS results object. See susieR documentation details.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/single_effect_regression.html","id":null,"dir":"Reference","previous_headings":"","what":"Bayesian single-effect linear regression — single_effect_regression","title":"Bayesian single-effect linear regression — single_effect_regression","text":"methods fit regression model \\(y = Xb +   e\\), elements e ..d.  \\(N(0,s^2)\\), b p-vector effects estimated. assumption b exactly one non-zero element, elements equally likely non-zero. prior coefficient non-zero element \\(N(0,V)\\).","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/single_effect_regression.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bayesian single-effect linear regression — single_effect_regression","text":"","code":"single_effect_regression(   Y,   X,   V,   residual_variance = 1,   prior_weights = NULL,   optimize_V = c(\"none\", \"optim\", \"uniroot\", \"EM\", \"simple\"),   check_null_threshold = 0 )  single_effect_regression_rss(   z,   Sigma,   V = 1,   prior_weights = NULL,   optimize_V = c(\"none\", \"optim\", \"uniroot\", \"EM\", \"simple\"),   check_null_threshold = 0 )  single_effect_regression_ss(   Xty,   dXtX,   V = 1,   residual_variance = 1,   prior_weights = NULL,   optimize_V = c(\"none\", \"optim\", \"uniroot\", \"EM\", \"simple\"),   check_null_threshold = 0 )"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/single_effect_regression.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bayesian single-effect linear regression — single_effect_regression","text":"Y n-vector. X n p matrix covariates. V scalar giving (initial) prior variance residual_variance residual variance. prior_weights p-vector prior weights. optimize_V optimization method use fitting prior variance. check_null_threshold Scalar specifying threshold log-scale compare likelihood current estimate zero null. z p-vector z scores. Sigma residual_var*R + lambda*Xty p-vector. dXtX p-vector containing diagonal elements crossprod(X).","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/single_effect_regression.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bayesian single-effect linear regression — single_effect_regression","text":"list following elements: alpha Vector posterior inclusion probabilities; alpha[] posterior probability ith coefficient non-zero. mu Vector posterior means (conditional inclusion). mu2 Vector posterior second moments (conditional inclusion). lbf Vector log-Bayes factors variable. lbf_model Log-Bayes factor single effect regression. single_effect_regression single_effect_regression_ss additionally output: V Prior variance (optimization optimize_V !=   \"none\"). loglik log-likelihood, \\(\\log p(y | X, V)\\).","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/single_effect_regression.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Bayesian single-effect linear regression — single_effect_regression","text":"single_effect_regression_ss performs single-effect linear regression summary data, statistcs \\(X^Ty\\) diagonal elements \\(X^TX\\) provided method. single_effect_regression_rss performs single-effect linear regression z scores. , function fits regression model \\(z = R*b + e\\), e \\(N(0,Sigma)\\), \\(Sigma = residual_var*R + lambda*\\), b p-vector effects estimated. assumption b exactly one non-zero element, elements equally likely non-zero. prior non-zero element \\(N(0,V)\\). required summary data p-vector z p p matrix Sigma. summary statistics come individuals.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/subset_sumstats.html","id":null,"dir":"Reference","previous_headings":"","what":"Subset summary statistics objects — subset_sumstats","title":"Subset summary statistics objects — subset_sumstats","text":"Subset summary statistics object (\"ss\") according indices provided idx, .e. retain SNPs positions given idx.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/subset_sumstats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Subset summary statistics objects — subset_sumstats","text":"","code":"subset_sumstats(ss, idx)"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/subset_sumstats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Subset summary statistics objects — subset_sumstats","text":"ss summary statistics list object, containing following fields (betas, stderrs, weights, Z required): betas matrix estimated effect sizes SNPs exposures, rows corresponding SNPs columns corresponding exposures. weights matrix weights learned SNP exposure, rows corresponding SNPs columns corresponding exposures. stderrs matrix standard errors betas. Z matrix z-scores exposures, equal betas divided stderrs. betas_y vector estimated effect sizes SNPs outcome. stderrs_y vector standard errors betas_y. zscores_y vector z-scores SNPs outcome, equal betas_y divided stderrs_y. pos vector SNP names. locus_idx vector matching SNPs locus come , indexed order loci read in_dir. annih_y vector containing portion betas_y projected factors; see annihilate_factors famr.R details orig_betas_y vector containing original betas_y latter modified annihilating factors; see annihilate_factors famr.R details orig_zscores_y Similar orig_betas_y zscores_y idx vector SNP indices retain ss","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/subset_sumstats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Subset summary statistics objects — subset_sumstats","text":"modified version ss SNPs specified idx kept.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/susie.html","id":null,"dir":"Reference","previous_headings":"","what":"Sum of Single Effects (SuSiE) Regression — susie","title":"Sum of Single Effects (SuSiE) Regression — susie","text":"Performs Bayesian multiple linear regression Y X; , function fits regression model \\(Y = \\sum_l   X b_{l=1}^L + e\\), elements e ..d. normal zero mean variance residual_variance, \\(\\sum_{l=1}^L b_l\\) vector length p representing effects estimated. “susie assumption” \\(b_l\\) exactly one non-zero element. prior non-zero element normal zero mean variance var(Y)   * scaled_prior_variance. model fitted using “Iterative Bayesian Stepwise Selection” (IBSS) algorithm. See also susie_trendfilter applying susie non-parametric regression, particularly changepoint problems.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/susie.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sum of Single Effects (SuSiE) Regression — susie","text":"","code":"susie(   X,   Y,   L = min(10, ncol(X)),   scaled_prior_variance = 0.2,   residual_variance = NULL,   prior_weights = NULL,   null_weight = NULL,   standardize = TRUE,   intercept = TRUE,   estimate_residual_variance = TRUE,   estimate_prior_variance = TRUE,   estimate_prior_method = c(\"optim\", \"EM\", \"simple\"),   check_null_threshold = 0,   prior_tol = 1e-09,   residual_variance_upperbound = Inf,   s_init = NULL,   coverage = 0.95,   min_abs_corr = 0.5,   compute_univariate_zscore = FALSE,   na.rm = FALSE,   max_iter = 100,   tol = 0.001,   verbose = FALSE,   track_fit = FALSE,   residual_variance_lowerbound = var(drop(Y))/10000,   refine = FALSE )  susie_suff_stat(   bhat,   shat,   R,   n,   var_y,   XtX,   Xty,   yty,   maf = NULL,   maf_thresh = 0,   L = 10,   scaled_prior_variance = 0.2,   residual_variance = NULL,   estimate_residual_variance = TRUE,   estimate_prior_variance = TRUE,   estimate_prior_method = c(\"optim\", \"EM\", \"simple\"),   check_null_threshold = 0,   prior_tol = 1e-09,   r_tol = 1e-08,   prior_weights = NULL,   null_weight = NULL,   standardize = TRUE,   max_iter = 100,   s_init = NULL,   intercept_value = 0,   coverage = 0.95,   min_abs_corr = 0.5,   tol = 0.001,   verbose = FALSE,   track_fit = FALSE,   check_input = FALSE,   refine = FALSE )"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/susie.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sum of Single Effects (SuSiE) Regression — susie","text":"X n p matrix covariates. Y observed responses, vector length n. L Number components (nonzero coefficients) susie regression model. L larger number covariates, p, L set p. scaled_prior_variance scaled prior variance. either scalar vector length L. prior variance non-zero element b set var(Y) *   scaled_prior_variance. estimate_prior_variance = TRUE, provides initial estimates prior variances. residual_variance Variance residual. estimate_residual_variance = TRUE, value provides initial estimate residual variance. default, var(Y). prior_weights vector length p, entry gives prior probability corresponding column X nonzero effect outcome, Y. null_weight Prior probability effect (number 0 1, exactly 1). standardize standardize = TRUE, standardize columns X (XtX Xty) unit variance prior fitting. Note scaled_prior_variance specifies prior coefficients X standardization (performed). standardize, may need think carefully specifying scaled_prior_variance. Whatever choice, coefficients returned coef given X original input scale. column X zero variance standardized. intercept intercept = TRUE, intercept fitted; intercept = FALSE, intercept set zero. Setting intercept = FALSE generally recommended. estimate_residual_variance estimate_residual_variance = TRUE, residual variance estimated, using residual_variance initial value. estimate_residual_variance = FALSE, residual variance fixed value supplied residual_variance. estimate_prior_variance estimate_prior_variance =   TRUE, prior variance estimated (separate parameter L effects). provided, scaled_prior_variance used initial value optimization. estimate_prior_variance = FALSE, prior variance L effects determined value supplied scaled_prior_variance. estimate_prior_method method used estimating prior variance. estimate_prior_method = \"simple\" used, likelihood specified prior variance compared likelihood variance zero, setting larger likelihood retained. check_null_threshold prior variance estimated, compare estimate null, set prior variance zero unless log-likelihood using estimate larger threshold amount. example, set check_null_threshold = 0.1, \"nudge\" estimate towards zero difference log-likelihoods small. note caution setting value greater zero may lead IBSS fitting procedure occasionally decrease ELBO. prior_tol prior variance estimated, compare estimated value prior_tol end computation, exclude single effect PIP computation estimated prior variance smaller tolerance value. residual_variance_upperbound Upper limit estimated residual variance. relevant estimate_residual_variance = TRUE. s_init previous susie fit initialize. coverage number 0 1 specifying “coverage” estimated confidence sets. min_abs_corr Minimum absolute correlation allowed credible set. default, 0.5, corresponds squared correlation 0.25, commonly used threshold genotype data genetic studies. compute_univariate_zscore compute_univariate_zscore   = TRUE, univariate regression z-scores outputted variable. na.rm Drop missing values Y X Y. max_iter Maximum number IBSS iterations perform. tol small, non-negative number specifying convergence tolerance IBSS fitting procedure. fitting procedure halt difference variational lower bound, “ELBO” (objective function maximized), less tol. verbose verbose = TRUE, algorithm's progress, summary optimization settings, printed console. track_fit track_fit = TRUE, trace also returned containing detailed information estimates iteration IBSS fitting procedure. residual_variance_lowerbound Lower limit estimated residual variance. relevant estimate_residual_variance = TRUE. refine refine = TRUE, use procedure help SuSiE get local optimum. bhat p-vector estimated effects. shat p-vector standard errors. R p p symmetric, positive semidefinite matrix. can \\(X'X\\), covariance matrix \\(X'X/(n-1)\\), correlation matrix. estimated samples used compute bhat shat. Using --sample matrix may produce unreliable results. n sample size. var_y sample variance y, defined \\(y'y/(n-1)\\). sample variance provided, coefficients (returned coef) computed \"standardized\" X, y scale. XtX p p matrix \\(X'X\\) columns X centered mean zero. Xty p-vector \\(X'y\\) y columns X centered mean zero. yty scalar \\(y'y\\) y centered mean zero. maf Minor allele frequency; used along maf_thresh filter input summary statistics. maf_thresh Variants minor allele frequency smaller threshold used. r_tol Tolerance level eigenvalue check positive semidefinite matrix R. intercept_value intercept. (intercept estimated centered summary data.) setting used coef assign intercept value, mainly consistency susie. Set NULL want coef include intercept term (p-vector returned). check_input check_input = TRUE, susie_suff_stat performs additional checks XtX Xty. checks : (1) check XtX positive semidefinite; (2) check Xty space spanned non-zero eigenvectors XtX. @keywords internal","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/susie.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sum of Single Effects (SuSiE) Regression — susie","text":"\"susie\" object following elements: alpha L p matrix posterior inclusion probabilites. mu L p matrix posterior means, conditional inclusion. mu2 L p matrix posterior second moments, conditional inclusion. Xr vector length n, equal X %*% colSums(alpha   * mu). lbf log-Bayes Factor single effect. lbf_variable log-Bayes Factor variable single effect. intercept Intercept (fixed estimated). sigma2 Residual variance (fixed estimated). V Prior variance non-zero elements b, equal scaled_prior_variance * var(Y). elbo value variational lower bound, “ELBO” (objective function maximized), achieved iteration IBSS fitting procedure. fitted Vector length n containing fitted values outcome. sets Credible sets estimated model fit; see susie_get_cs details. pip vector length p giving (marginal) posterior inclusion probabilities p covariates. z vector univariate z-scores. niter Number IBSS iterations performed. converged TRUE FALSE indicating whether IBSS converged solution within chosen tolerance level. susie_suff_stat returns also outputs: XtXr p-vector t(X) times fitted values, X %*% colSums(alpha*mu).","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/susie.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Sum of Single Effects (SuSiE) Regression — susie","text":"susie_suff_stat performs sum single-effect linear regression summary statistics. required summary data either: bhat, shat, p p symmetric, positive semidefinite correlation (covariance) matrix R, sample size n, variance y; p p matrix \\(X'X\\), p-vector \\(X'y\\), sum squares \\(y'y\\), sample size n. summary statistics come individuals. columns X vector y centered mean zero computing summary statistics; may also want scale column X y variance 1 (see examples).","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/susie.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Sum of Single Effects (SuSiE) Regression — susie","text":"G. Wang, . Sarkar, P. Carbonetto M. Stephens (2020). simple new approach variable selection regression, application genetic fine-mapping. Journal Royal Statistical Society, Series B https://doi.org/10.1101/501114.","code":""},{"path":[]},{"path":"http://www.nathanrlapierre.com/FAMR/reference/susie_get_methods.html","id":null,"dir":"Reference","previous_headings":"","what":"Inferences From Fitted SuSiE Model — susie_get_objective","title":"Inferences From Fitted SuSiE Model — susie_get_objective","text":"functions access basic properties draw inferences fitted susie model.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/susie_get_methods.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inferences From Fitted SuSiE Model — susie_get_objective","text":"","code":"susie_get_objective(res, last_only = TRUE, warning_tol = 1e-06)  susie_get_posterior_mean(res, prior_tol = 1e-09)  susie_get_posterior_sd(res, prior_tol = 1e-09)  susie_get_niter(res)  susie_get_prior_variance(res)  susie_get_residual_variance(res)  susie_get_lfsr(res)  susie_get_posterior_samples(susie_fit, num_samples)  susie_get_cs(   res,   X = NULL,   Xcorr = NULL,   coverage = 0.95,   min_abs_corr = 0.5,   dedup = TRUE,   squared = FALSE )  susie_get_pip(res, prune_by_cs = FALSE, prior_tol = 1e-09)"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/susie_get_methods.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inferences From Fitted SuSiE Model — susie_get_objective","text":"res susie fit, typically output susie one variants. susie_get_pip susie_get_cs, may instead posterior inclusion probability matrix, alpha. last_only last_only = FALSE, return ELBO iterations; otherwise return ELBO last iteration . warning_tol Warn ELBO decreasing tolerance level. prior_tol Filter effects estimated prior variance smaller threshold. @keywords internal susie_fit susie fit, output susie. num_samples number draws posterior distribution. X n p matrix values p variables (covariates) n samples. provided, correlation variables computed used remove CSs whose minimum correlation among variables smaller min_abs_corr. Xcorr p p matrix correlations variables (covariates). provided, used remove CSs whose minimum correlation among variables smaller min_abs_corr. coverage number 0 1 specifying desired coverage CS. min_abs_corr \"purity\" threshold CS. CS contains pair variables correlation less threshold filtered reported. dedup dedup = TRUE, remove duplicate CSs. squared squared = TRUE, report min, mean median squared correlation instead absolute correlation. prune_by_cs Whether ignore single effects reported CS calculating PIP.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/susie_get_methods.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Inferences From Fitted SuSiE Model — susie_get_objective","text":"susie_get_objective returns evidence lower bound (ELBO) achieved fitted susie model , optionally, iteration IBSS fitting procedure. susie_get_residual_variance returns (estimated fixed) residual variance parameter. susie_get_prior_variance returns (estimated fixed) prior variance parameters. susie_get_posterior_mean returns posterior mean regression coefficients fitted susie model. susie_get_posterior_sd returns posterior standard deviation coefficients fitted susie model. susie_get_niter returns number model fitting iterations performed. susie_get_pip returns vector containing posterior inclusion probabilities (PIPs) variables. susie_get_lfsr returns vector containing average lfsr across variables single-effect, weighted posterior inclusion probability (alpha). susie_get_posterior_samples returns list containing effect sizes samples causal status two components: b, num_variables x num_samples matrix effect sizes; gamma, num_variables x num_samples matrix causal status random draws. susie_get_cs returns credible sets (CSs) susie fit, well summaries correlation among variables included CS. desired, one can filter CSs meet specified “purity” threshold; , either X Xcorr must supplied. returns list following elements: cs list list element vector containing indices variables CS. coverage nominal coverage specified CS. purity X Xcorr iis provided), purity CS. cs_index X Xcorr provided) index (number 1 L) reported CS supplied susie fit.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/susie_init_coef.html","id":null,"dir":"Reference","previous_headings":"","what":"Initialize a susie object using regression coefficients — susie_init_coef","title":"Initialize a susie object using regression coefficients — susie_init_coef","text":"Initialize susie object using regression coefficients","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/susie_init_coef.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Initialize a susie object using regression coefficients — susie_init_coef","text":"","code":"susie_init_coef(coef_index, coef_value, p)"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/susie_init_coef.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Initialize a susie object using regression coefficients — susie_init_coef","text":"coef_index L-vector containing indices nonzero coefficients. coef_value L-vector containing initial coefficient estimates. p scalar giving number variables.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/susie_init_coef.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Initialize a susie object using regression coefficients — susie_init_coef","text":"list elements alpha, mu mu2 used susie.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/susie_rss.html","id":null,"dir":"Reference","previous_headings":"","what":"Sum of Single Effects (SuSiE) Regression using summary statistics — susie_rss","title":"Sum of Single Effects (SuSiE) Regression using summary statistics — susie_rss","text":"susie_rss performs sum single-effect linear regression z scores; posterior calculations z-scores. function fits regression model \\(z = \\sum_l   R*b_l + e\\), e \\(N(0,R)\\) \\(\\sum_l b_l\\) p-vector effects estimated. required summary data p p correlation matrix, R, p-vector z.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/susie_rss.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sum of Single Effects (SuSiE) Regression using summary statistics — susie_rss","text":"","code":"susie_rss(   z,   R,   maf = NULL,   maf_thresh = 0,   z_ld_weight = 0,   L = 10,   prior_variance = 50,   residual_variance = NULL,   prior_weights = NULL,   null_weight = NULL,   estimate_residual_variance = FALSE,   estimate_prior_variance = TRUE,   estimate_prior_method = c(\"optim\", \"EM\", \"simple\"),   check_null_threshold = 0,   prior_tol = 1e-09,   max_iter = 100,   s_init = NULL,   intercept_value = 0,   coverage = 0.95,   min_abs_corr = 0.5,   tol = 0.001,   verbose = FALSE,   track_fit = FALSE,   check_R = FALSE,   r_tol = 1e-08,   refine = FALSE )"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/susie_rss.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sum of Single Effects (SuSiE) Regression using summary statistics — susie_rss","text":"z p-vector z scores. R p p symmetric, positive semidefinite correlation matrix. maf Minor allele frequency; used along maf_thresh filter input summary statistics. maf_thresh Variants minor allele frequency smaller threshold used. z_ld_weight feature recommended. weights assigned z scores LD matrix. z_ld_weight >   0, LD matrix used model cov2cor((1-w)*R +   w*tcrossprod(z)), w = z_ld_weight. L Number components (nonzero coefficients) susie regression model. L larger number covariates, p, L set p. prior_variance prior variance. either scalar vector length L. residual_variance Variance residual. specified, set 1. prior_weights vector length p, entry gives prior probability SNP j non-zero effect. null_weight Prior probability effect (number 0 1, exactly 1). estimate_residual_variance residual variance fixed value supplied residual_variance. estimate residual variance susie_rss. estimate_prior_variance estimate_prior_variance =   TRUE, prior variance estimated (separate parameter L effects). provided, prior_variance used initial value optimization. estimate_prior_variance = FALSE, prior variance L effects determined value supplied prior_variance. estimate_prior_method method used estimating prior variance. estimate_prior_method = \"simple\" used, likelihood specified prior variance compared likelihood variance zero, setting larger likelihood retained. check_null_threshold prior variance estimated, compare estimate null, set prior variance zero unless log-likelihood using estimate larger threshold amount. example, set check_null_threshold = 0.1, \"nudge\" estimate towards zero difference log-likelihoods small. note caution setting value greater zero may lead IBSS fitting procedure occasionally decrease ELBO. prior_tol prior variance estimated, compare estimated value prior_tol end computation, exclude single effect PIP computation estimated prior variance smaller tolerance value. max_iter Maximum number IBSS iterations perform. s_init previous susie fit initialize. intercept_value intercept. (intercept estimated centered summary data.) setting used coef assign intercept value, mainly consistency susie. Set NULL want coef include intercept term (p-vector returned). coverage number 0 1 specifying “coverage” estimated confidence sets. min_abs_corr Minimum absolute correlation allowed credible set. default, 0.5, corresponds squared correlation 0.25, commonly used threshold genotype data genetic studies. tol small, non-negative number specifying convergence tolerance IBSS fitting procedure. fitting procedure halt difference variational lower bound, “ELBO” (objective function maximized), less tol. verbose verbose = TRUE, algorithm's progress, summary optimization settings, printed console. track_fit track_fit = TRUE, trace also returned containing detailed information estimates iteration IBSS fitting procedure. check_R check_R = TRUE, check R positive semidefinite. r_tol Tolerance level eigenvalue check positive semidefinite matrix R. refine refine = TRUE, use procedure help SuSiE get local optimum.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/susie_rss.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sum of Single Effects (SuSiE) Regression using summary statistics — susie_rss","text":"\"susie\" object following elements: alpha L p matrix posterior inclusion probabilites. mu L p matrix posterior means, conditional inclusion. mu2 L p matrix posterior second moments, conditional inclusion. lbf log-Bayes Factor single effect. lbf_variable log-Bayes Factor variable single effect. intercept Fixed Intercept. sigma2 Fixed Residual variance. V Prior variance non-zero elements b, equal scaled_prior_variance * var(Y). elbo value variational lower bound, “ELBO” (objective function maximized), achieved iteration IBSS fitting procedure. fitted Vector length n containing fitted values outcome. sets Credible sets estimated model fit; see susie_get_cs details. pip vector length p giving (marginal) posterior inclusion probabilities p covariates. niter Number IBSS iterations performed. converged TRUE FALSE indicating whether IBSS converged solution within chosen tolerance level. Rr p-vector t(X) times fitted values, X   %*% colSums(alpha*mu). @keywords internal","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/univariate_regression.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform Univariate Linear Regression Separately for Columns of X — univariate_regression","title":"Perform Univariate Linear Regression Separately for Columns of X — univariate_regression","text":"function performs univariate linear regression y ~ x separately column x X. regression implemented using .lm.fit(). estimated effect size stardard error variable outputted.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/univariate_regression.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform Univariate Linear Regression Separately for Columns of X — univariate_regression","text":"","code":"univariate_regression(   X,   y,   Z = NULL,   center = TRUE,   scale = FALSE,   return_residuals = FALSE )"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/univariate_regression.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform Univariate Linear Regression Separately for Columns of X — univariate_regression","text":"X n p matrix regressors. y n-vector response variables. Z Optional n k matrix covariates included regresions. Z NULL, linear effects covariates removed y first, resulting residuals used place y. center center = TRUE, center X, y Z. scale scale = TRUE, scale X, y Z. return_residuals Whether output residuals Z NULL.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/univariate_regression.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform Univariate Linear Regression Separately for Columns of X — univariate_regression","text":"list two vectors containing least-squares estimates coefficients (betahat) standard errors (sebetahat). Optionally, matrix covariates Z provided, third vector residuals containing residuals returned.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/update_alpha_tau2.html","id":null,"dir":"Reference","previous_headings":"","what":"Update posterior parameters after running Susie-RSS — update_alpha_tau2","title":"Update posterior parameters after running Susie-RSS — update_alpha_tau2","text":"Given Susie-RSS results, updates PIP (alpha) posterior mean (post_mu) posterior variance (tau2) variable \"class\" (SNPs exposures/factors). Part cTWAS Expectation-Maximization (EM) algorithm fit class-specific prior parameters Susie-RSS.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/update_alpha_tau2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Update posterior parameters after running Susie-RSS — update_alpha_tau2","text":"","code":"update_alpha_tau2(res, n_vars)"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/update_alpha_tau2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Update posterior parameters after running Susie-RSS — update_alpha_tau2","text":"res Susie-RSS results object generated run_susie_with_priors; see susieR documentation details. relevantly function, contains following elements: pip numeric vector Posterior Inclusion Probabilities (PIPs) variable mu numeric matrix posterior mean estimates variable credible set, one row per credible set one column per variable mu2 Similar mu, posterior second moments alpha numeric matrix PIPs credible set, one row per credible set one column per variable n_vars list object giving number variables class, e.g. ('SNPs' = 10000, 'exposures' = 30)","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/update_alpha_tau2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Update posterior parameters after running Susie-RSS — update_alpha_tau2","text":"list object following elements: alpha list object elements class variables, containing numeric vector PIPs variables class tau2 list object elements class variables, containing numeric vector posterior second moments (conditioned variable effect) variables class post_mu list object elements class variables, containing numeric vector posterior mean effect size estimates variables class","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/update_pi_sigma2.html","id":null,"dir":"Reference","previous_headings":"","what":"Update cTWAS priors — update_pi_sigma2","title":"Update cTWAS priors — update_pi_sigma2","text":"Given updated posterior parameters learned running Susie-RSS given previous cTWAS priors, update cTWAS prior inclusion probability prior variance class variables (.e. SNPs exposures/factors). Part cTWAS EM algorithm.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/update_pi_sigma2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Update cTWAS priors — update_pi_sigma2","text":"","code":"update_pi_sigma2(alpha, tau2)"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/update_pi_sigma2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Update cTWAS priors — update_pi_sigma2","text":"alpha list object elements class variables, containing numeric vector PIPs variables class. Usually generated update_alpha_tau2. tau2 list object elements class variables, containing numeric vector posterior second moments (conditioned variable effect) variables class. Usually generated update_alpha_tau2.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/update_pi_sigma2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Update cTWAS priors — update_pi_sigma2","text":"list object following elements: pi list containing updated cTWAS prior inclusion probability (prior probability effect trait) class variables sigma2 list containing updated cTWAS prior effect variances, conditioned variable effect, class variables","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/warn_low_instrument.html","id":null,"dir":"Reference","previous_headings":"","what":"Warn user about traits with low number of instruments — warn_low_instrument","title":"Warn user about traits with low number of instruments — warn_low_instrument","text":"Traits instruments nonzero weights may poorly predicted thus provide somewhat less reliable results MR analysis. helper functions warns users case.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/warn_low_instrument.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Warn user about traits with low number of instruments — warn_low_instrument","text":"","code":"warn_low_instrument(weights, trait_names, min_instruments = 10)"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/warn_low_instrument.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Warn user about traits with low number of instruments — warn_low_instrument","text":"weights matrix learned instrument-exposure/factor weights trait_names vector names traits min_instruments Minimum number instruments; traits fewer instruments trigger warning","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/warn_low_instrument.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Warn user about traits with low number of instruments — warn_low_instrument","text":"vector trait names fewer min_instruments instruments non-zero weights","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/write_famr_res.html","id":null,"dir":"Reference","previous_headings":"","what":"Write FAMR-Susie results to a file — write_famr_res","title":"Write FAMR-Susie results to a file — write_famr_res","text":"Writes FAMR-Susie results file, optionally simple results summary additional text file. Mainly intended used internally simulations.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/write_famr_res.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Write FAMR-Susie results to a file — write_famr_res","text":"","code":"write_famr_res(out, famr_res, K, fa_method, for_sim = F)"},{"path":"http://www.nathanrlapierre.com/FAMR/reference/write_famr_res.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Write FAMR-Susie results to a file — write_famr_res","text":"Base name output files famr_res FAMR-Susie results object; see famr_susie method famr.R details. K number exposures analysis. fa_method factor analysis method used infer factors FAMR-Susie. for_sim boolen indicating whether generate additional text file output use internal simulations.","code":""},{"path":"http://www.nathanrlapierre.com/FAMR/reference/write_famr_res.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Write FAMR-Susie results to a file — write_famr_res","text":"nothing","code":""}]
